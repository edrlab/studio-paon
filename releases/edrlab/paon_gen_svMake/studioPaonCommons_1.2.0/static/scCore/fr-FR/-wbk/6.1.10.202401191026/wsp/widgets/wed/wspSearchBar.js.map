{"version":3,"sources":["/@back@/wsp/widgets/wed/wspSearchBar.tsx"],"names":["REG","DOMSH","SearchBarPanelAction","SearchPanelBase","SrcPointer","SrcPointerErase","SrcPointerFastSelect","SrcPointerPaste","SkCommentSearch","SkItemSearch","JSX","Button","isSkSearchAnnot","EWedletEditMode","WEDLET","POPUP","XA","ItemSearchAction","[object Object]","id","maxResults","super","this","_icon","_label","_description","ctx","ev","ItemSearchPanel","initPanel","reg","addToList","action","bar","_initPanel","findPtr","initialize","defaultAction","SINGLETON","actionsLists","accelKeysLists","draggable","dropable","title","onSrcRefChange","add","onChange","searchBar","append","nav","result","params","findRef","setSrcRef","execSearch","repRef","undefined","showReplaceBar","repPtr","searchId","getId","srcRef","replaceBarShown","onRepChange","repBtn","createElement","label","onclick","onReplace","disabled","repAllBtn","onReplaceAll","replaceBar","srcPtr","me","findHost","dispatchSearchChange","repBy","annot","getLastSelectedAnnot","wedMgr","start","freeze","startWedlet","findWedlet","rootWedlet","lastAncestorIfNone","resolveEditMode","write","batch","docHolder","newBatch","getCurrentSel","setAttr","setSelAfter","doBatch","showNotifForbidden","viewPortX","viewPortY","gotoAnnot","annots","lastSkAnnots","lastAn","i","length","an","setSkSearch","updateCount","connectDoc","focus","addAction","accel","customElements","define","CommentSearchAction","CommentSearchPanel","opened","type","onchange","checked","closed","shadowRoot","class","panel"],"mappings":"OAAcA,QAAI;OAEVC,UAAM;OACgCC,qBAAsBC,oBAA8B;OAE1FC,WAAYC,gBAAiBC,qBAAsBC,oBAAgB;OAEnEC,gBAAiBC,iBAAa;OAG9BC,QAAI;OACJC,WAAO;OACSC,oBAAgB;OAEhCC,gBAAiBC,WAAO;OACxBC,UAAM;OACNC,OAAG;AAGX,MAAMC,yBAAyBf,qBAE9BgB,YAAYC,GAAaC,YACxBC,MAAMF,IAAM;AACZG,KAAKF,WAAaA,YAAc;AAChCE,KAAKC,MAAQ;AACbD,KAAKE,OAAS;AACdF,KAAKG,aAAe,sCAGrBP,WAAWQ,IAAmBC,IAC7B,OAAO,IAAIC,iBAAkBC,UAAUP,KAAMI,MAI/C1B,IAAI8B,IAAIC,UAAU,wBAAyB,OAAQ,EAAG,IAAId,iBAAoB;AAS9E,MAAMW,wBAAwBzB,gBAQ7Be,UAAUc,OAA0BC,KACnCX,KAAKY,WAAWF,OAAQC,IAAK;AAC7BX,KAAKa,SAAU,IAAI/B,YAAagC,WAAW,CAC1CN,IAAKR,KAAKQ,IACVO,cAAe/B,qBAAqBgC,UACpCC,aAAc,CAAC,6BAA8B,yBAC7CC,eAAgB,CAAC,+BAAgC,2BACjDC,UAAW,KACXC,SAAU;AAEXpB,KAAKa,QAAQQ,MAAQ;AACrBrB,KAAKa,QAAQS,eAAeC,IAAIvB,KAAKwB;AACrCxB,KAAKyB,UAAUC,OACd1B,KAAKa,QACLb,KAAK2B,IACL3B,KAAK4B;AAEN,OAAO5B,KAGRJ,UAAUiC,QACT,GAAIA,OAAOC,SAAW,KAAM9B,KAAKa,QAAQkB,UAAUF,OAAOC;AAC1D9B,KAAKgC;AACL,GAAIH,OAAOI,SAAWC,UAAW,CAChClC,KAAKmC,eAAe;AACpBnC,KAAKoC,OAAOL,UAAUF,OAAOI,SAI/BrC,cACC,MAAO,CACNyC,SAAUrC,KAAKU,OAAO4B,QACtBR,QAAS9B,KAAKa,QAAQ0B,OACtBN,OAAQjC,KAAKwC,gBAAkBxC,KAAKoC,OAAOG,OAASL,WAK5CtC,kBACTI,KAAKoC,QAAS,IAAItD,YAAagC,WAAW,CACzCN,IAAKR,KAAKQ,IACVO,cAAe/B,qBAAqBgC,UACpCC,aAAc,CAAC,6BAA8B,yBAC7CC,eAAgB,CAAC,+BAAgC,2BACjDC,UAAW,KACXC,SAAU;AAEXpB,KAAKoC,OAAOf,MAAQ;AACpBrB,KAAKoC,OAAOd,eAAeC,IAAIvB,KAAKyC;AACpCzC,KAAK0C,OAAStD,IAAAuD,cAACtD,OAAM,CAACuD,MAAM,cAAcC,QAAS7C,KAAK8C,UAAWC,SAAQ;AAC3E/C,KAAKgD,UAAY5D,IAAAuD,cAACtD,OAAM,CAACuD,MAAM,mBAAmBC,QAAS7C,KAAKiD,aAAcF,SAAQ;AACtF/C,KAAKkD,WAAWxB,OACf1B,KAAKoC,OACLpC,KAAK0C,OACL1C,KAAKgD,WAIGpD,SAAqBuD,QAC9B,MAAMC,GAAKzE,MAAM0E,SAA0BF;AAC3CC,GAAGpB;AACHrD,MAAM0E,SAAuBD,IAAIE,uBAGxB1D,YAAwBuD,QACjC,MAAMC,GAAKzE,MAAM0E,SAA0BF;AAC3C,MAAMJ,UAAYI,OAAOZ;AACzBa,GAAGV,OAAOK,SAAWA;AACrBK,GAAGJ,UAAUD,SAAWA,SAGfnD,YACT,MAAMwD,GAAKzE,MAAM0E,SAA0BrD;AAC3C,MAAMuD,MAAQH,GAAGhB,OAAOG;AACxB,IAAKgB,MAAO;AACZ,MAAMC,MAAQJ,GAAGzB,IAAI8B;AACrB,GAAID,MAAO,CACV,MAAME,OAASN,GAAGM;AAClB,MAAMC,MAAQjE,GAAGkE,OAAOJ,MAAMG;AAC9B,MAAME,YAAcrE,OAAOsE,WAAWJ,OAAOK,WAAYJ,MAAO,CAACK,mBAAoB;AACrF,GAAIH,aAAerE,OAAOyE,gBAAgBJ,eAAiBtE,gBAAgB2E,MAAO,CACjF,MAAMC,MAAQf,GAAGM,OAAOU,UAAUC,SAASjB,GAAGM,OAAOY;AACrDH,MAAMI,QAAQZ,MAAOJ;AACrBY,MAAMK,YAAYb;AAClBQ,MAAMM,cACA,CACNhF,MAAMiF,mBAAmB,2BAA4B1E,KAAM,KAAM,CAAC2E,UAAW,SAAUC,UAAW,SAGpGxB,GAAGzB,IAAIkD,UAAU,GAGRjF,eACT,MAAMwD,GAAKzE,MAAM0E,SAA0BrD;AAC3C,MAAMuD,MAAQH,GAAGhB,OAAOG;AACxB,IAAKgB,MAAO;AACZ,MAAMG,OAASN,GAAGM;AAClB,MAAMS,MAAQT,OAAOU,UAAUC,SAASX,OAAOY;AAC/C,MAAMQ,OAASpB,OAAOqB;AACtB,IAAIC;AACJ,IAAK,IAAIC,EAAIH,OAAOI,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC5C,MAAME,GAAeL,OAAOG;AAC5B,GAAI3F,gBAAgB6F,IAAK,CACxB,MAAMxB,MAAQjE,GAAGkE,OAAOuB,GAAGxB;AAC3B,MAAME,YAAcrE,OAAOsE,WAAWJ,OAAOK,WAAYJ,MAAO,CAACK,mBAAoB;AAErF,GAAIH,aAAerE,OAAOyE,gBAAgBJ,eAAiBtE,gBAAgB2E,MAAOC,MAAMI,QAAQZ,MAAOJ;AACvG,IAAKyB,OAAQA,OAASG,IAGxB,GAAIH,OAAQ,CACXb,MAAMK,YAAYQ,OAAOrB;AACzBQ,MAAMM,cACA,CACNrB,GAAGzB,IAAIkD,UAAU,IAInBjF,aACC,IAAKI,KAAK0D,OAAQ;AAClB,GAAI1D,KAAK0D,OAAOU,UAAUgB,YAAY,IAAIjG,aAAaa,KAAKa,QAAQ0B,OAAQvC,KAAKU,OAAOZ,aAAaoF,SAAW,EAAG,CAClHlF,KAAKqF,YAAY,IAInBzF,WAAW8D,QACV3D,MAAMuF,WAAW5B;AACjB1D,KAAKa,QAAQ0E,SAIf,SAASC,UAAU9E,OAA+B+E,OACjD/G,IAAI8B,IAAIC,UAAU,6BAA8BC,OAAO4B,QAAS,EAAG5B;AACnE,GAAI+E,MAAO/G,IAAI8B,IAAIC,UAAU,+BAAgCgF,MAAO,EAAG/E,QAGxE8E,UAAUxG,qBAAqBgC,UAAW;AAC1CwE,UAAUvG,gBAAgB+B,UAAW;AACrCwE,UAAU,IAAIzG,gBAAmB;AAEjC2G,eAAeC,OAAO,qBAAsBrF;AAM5C,MAAMsF,4BAA4BhH,qBAEjCgB,YAAYC,GAAaC,YACxBC,MAAMF,IAAM;AACZG,KAAKF,WAAaA,YAAc;AAChCE,KAAKC,MAAQ;AACbD,KAAKE,OAAS,+BAGfN,WAAWQ,IAAmBC,IAC7B,OAAO,IAAIwF,oBAAqBtF,UAAUP,KAAMI,MAIlD1B,IAAI8B,IAAIC,UAAU,wBAAyB,UAAW,EAAG,IAAImF,oBAAuB;AAQpF,MAAMC,2BAA2BhH,gBAMhCe,UAAUc,OAA6BC,KACtCX,KAAKY,WAAWF,OAAQC,IAAK;AAC7BX,KAAK8F,OAAS1G,IAAAuD,cAAA,QAAA,CAAOoD,KAAK,WAAWC,SAAUhG,KAAKwB,SAAUyE,QAAQ;AACtEjG,KAAKkG,OAAS9G,IAAAuD,cAAA,QAAA,CAAOoD,KAAK,WAAWC,SAAUhG,KAAKwB,SAAUyE,QAAQ;AACtEjG,KAAKmG,WAAWzE,OACf1B,KAAK2B,IACLvC,IAAAuD,cAAA,MAAA,CAAKyD,MAAM,WACVhH,IAAAuD,cAAA,QAAA,KAAQ3C,KAAK8F,oBACb1G,IAAAuD,cAAA,QAAA,KAAQ3C,KAAKkG,kBAEdlG,KAAK4B;AAEN,OAAO5B,KAGRJ,UAAUiC,QACT,UAAWA,OAAOiE,SAAW,UAAW9F,KAAK8F,OAAOG,QAAUpE,OAAOiE;AACrE,UAAWjE,OAAOqE,SAAW,UAAWlG,KAAKkG,OAAOD,QAAUpE,OAAOqE;AACrElG,KAAKgC,aAGNpC,cACC,MAAO,CACNyC,SAAUrC,KAAKU,OAAO4B,QACtBwD,OAAQ9F,KAAK8F,OAAOG,QACpBC,OAAQlG,KAAKkG,OAAOD,SAIZrG,WACT,MAAMyG,MAAQ1H,MAAM0E,SAA6BrD;AACjD,IAAKqG,MAAMP,OAAOG,UAAYI,MAAMH,OAAOD,QAAS,CAEnD,GAAIjG,OAASqG,MAAMP,OAAQ,CAC1BO,MAAMH,OAAOD,QAAU,SACjB,CACNI,MAAMP,OAAOG,QAAU,MAGzBI,MAAMrE;AACNrD,MAAM0E,SAAuBgD,OAAO/C,uBAGrC1D,aACC,IAAKI,KAAK0D,OAAQ;AAClB,GAAI1D,KAAK0D,OAAOU,UAAUgB,YAAY,IAAIlG,gBAAgBc,KAAK8F,OAAOG,QAASjG,KAAKkG,OAAOD,QAASjG,KAAKU,OAAOZ,aAAaoF,SAAW,EAAG,CAC1IlF,KAAKqF,YAAY,KAKpBK,eAAeC,OAAO,wBAAyBE","sourcesContent":["import {IReg, REG} from \"lib/commons/registry\";\nimport {WedMgr} from \"back/edit/wed/wedEditor\";\nimport {DOMSH} from \"lib/commons/xml/domsh\";\nimport {ISearchBarPanel, JWedSearchBarParams, SearchBarPanelAction, SearchPanelBase, WedSearchBar} from \"back/edit/wed/features/searchBar\";\nimport {srcRef} from \"lib/wsp/src\";\nimport {SrcPointer, SrcPointerErase, SrcPointerFastSelect, SrcPointerPaste} from \"back/wsp/widgets/srcDrawer\";\nimport {IWspUiEnv} from \"lib/wsp/wsp\";\nimport {SkCommentSearch, SkItemSearch} from \"back/wsp/widgets/wed/schemaMetaWsp\";\nimport {Action} from \"lib/commons/actions\";\nimport {IShortDescCtx} from \"lib/wsp/item\";\nimport {JSX} from \"lib/commons/xml/dom\";\nimport {Button} from \"back/commons/widgets/buttons\";\nimport {ISkSearchAnnot, isSkSearchAnnot} from \"lib/edit/schema/schemaSearch\";\nimport {ISkAnnot} from \"lib/edit/schema/schemaAnnots\";\nimport {EWedletEditMode, WEDLET} from \"back/edit/wed/wedlets/wedlet\";\nimport {POPUP} from \"back/commons/widgets/popups\";\nimport {XA} from \"lib/commons/xml/xAddr\";\n\n/** Barre de parcours des liens vers des items. */\nclass ItemSearchAction extends SearchBarPanelAction {\n\n\tconstructor(id?: string, maxResults?: number) {\n\t\tsuper(id || 'item');\n\t\tthis.maxResults = maxResults || 300;\n\t\tthis._icon = \"/@skin@/edit/wed/search/linkSearch.svg\";\n\t\tthis._label = \"Parcourir les liens\";\n\t\tthis._description = \"Chercher les liens vers les items\";\n\t}\n\n\tbuildPanel(ctx: WedSearchBar, ev?: Event): ISearchBarPanel {\n\t\treturn new ItemSearchPanel().initPanel(this, ctx);\n\t}\n}\n\nREG.reg.addToList(\"wed.searchBar.actions\", \"item\", 1, new ItemSearchAction(), 50);\n\n\nexport interface JItemWedSearchBarParams extends JWedSearchBarParams {\n\tfindRef?: srcRef\n\trepRef?: srcRef\n}\n\n/** */\nclass ItemSearchPanel extends SearchPanelBase {\n\taction: ItemSearchAction;\n\treg: IReg<IWspUiEnv>;\n\tfindPtr: SrcPointer;\n\trepPtr: SrcPointer;\n\trepBtn: Button;\n\trepAllBtn: Button;\n\n\tinitPanel(action: ItemSearchAction, bar: WedSearchBar): this {\n\t\tthis._initPanel(action, bar, true);\n\t\tthis.findPtr = new SrcPointer().initialize({\n\t\t\treg: this.reg,\n\t\t\tdefaultAction: SrcPointerFastSelect.SINGLETON,\n\t\t\tactionsLists: [\"actions:wsp:wed:itemSearch\", \"actions:wsp:shortDesc\"],\n\t\t\taccelKeysLists: [\"accelkeys:wsp:wed:itemSearch\", \"accelkeys:wsp:shortDesc\"],\n\t\t\tdraggable: true,\n\t\t\tdropable: true\n\t\t});\n\t\tthis.findPtr.title = \"Lien vers un item particulier\";\n\t\tthis.findPtr.onSrcRefChange.add(this.onChange);\n\t\tthis.searchBar.append(\n\t\t\tthis.findPtr,\n\t\t\tthis.nav,\n\t\t\tthis.result\n\t\t);\n\t\treturn this;\n\t}\n\n\tsetSearch(params: JItemWedSearchBarParams): void {\n\t\tif (params.findRef != null) this.findPtr.setSrcRef(params.findRef);\n\t\tthis.execSearch();\n\t\tif (params.repRef !== undefined) {\n\t\t\tthis.showReplaceBar(true);\n\t\t\tthis.repPtr.setSrcRef(params.repRef);\n\t\t}\n\t}\n\n\tbuildSearch(): JItemWedSearchBarParams {\n\t\treturn {\n\t\t\tsearchId: this.action.getId(),\n\t\t\tfindRef: this.findPtr.srcRef,\n\t\t\trepRef: this.replaceBarShown ? this.repPtr.srcRef : undefined\n\t\t}\n\t}\n\n\n\tprotected buildReplaceBar() {\n\t\tthis.repPtr = new SrcPointer().initialize({\n\t\t\treg: this.reg,\n\t\t\tdefaultAction: SrcPointerFastSelect.SINGLETON,\n\t\t\tactionsLists: [\"actions:wsp:wed:itemSearch\", \"actions:wsp:shortDesc\"],\n\t\t\taccelKeysLists: [\"accelkeys:wsp:wed:itemSearch\", \"accelkeys:wsp:shortDesc\"],\n\t\t\tdraggable: true,\n\t\t\tdropable: true\n\t\t});\n\t\tthis.repPtr.title = \"Remplacer par cet item\";\n\t\tthis.repPtr.onSrcRefChange.add(this.onRepChange);\n\t\tthis.repBtn = <Button label=\"Remplacer\" onclick={this.onReplace} disabled/> as Button;\n\t\tthis.repAllBtn = <Button label=\"Tout remplacer\" onclick={this.onReplaceAll} disabled/> as Button;\n\t\tthis.replaceBar.append(\n\t\t\tthis.repPtr,\n\t\t\tthis.repBtn,\n\t\t\tthis.repAllBtn\n\t\t);\n\t}\n\n\tprotected onChange(this: void, srcPtr: SrcPointer) {\n\t\tconst me = DOMSH.findHost<ItemSearchPanel>(srcPtr);\n\t\tme.execSearch();\n\t\tDOMSH.findHost<WedSearchBar>(me).dispatchSearchChange();\n\t}\n\n\tprotected onRepChange(this: void, srcPtr: SrcPointer) {\n\t\tconst me = DOMSH.findHost<ItemSearchPanel>(srcPtr);\n\t\tconst disabled = !srcPtr.srcRef;\n\t\tme.repBtn.disabled = disabled;\n\t\tme.repAllBtn.disabled = disabled;\n\t}\n\n\tprotected onReplace(this: HTMLInputElement) {\n\t\tconst me = DOMSH.findHost<ItemSearchPanel>(this);\n\t\tconst repBy = me.repPtr.srcRef;\n\t\tif (!repBy) return;\n\t\tconst annot = me.nav.getLastSelectedAnnot();\n\t\tif (annot) {\n\t\t\tconst wedMgr = me.wedMgr;\n\t\t\tconst start = XA.freeze(annot.start);\n\t\t\tconst startWedlet = WEDLET.findWedlet(wedMgr.rootWedlet, start, {lastAncestorIfNone: true});\n\t\t\tif (startWedlet && WEDLET.resolveEditMode(startWedlet) === EWedletEditMode.write) {\n\t\t\t\tconst batch = me.wedMgr.docHolder.newBatch(me.wedMgr.getCurrentSel());\n\t\t\t\tbatch.setAttr(start, repBy);\n\t\t\t\tbatch.setSelAfter(start);\n\t\t\t\tbatch.doBatch();\n\t\t\t} else {\n\t\t\t\tPOPUP.showNotifForbidden(\"Contenu non modifiable\", this, null, {viewPortX: \"middle\", viewPortY: \"1/3\"});\n\t\t\t}\n\t\t}\n\t\tme.nav.gotoAnnot(1);\n\t}\n\n\tprotected onReplaceAll(this: HTMLInputElement) {\n\t\tconst me = DOMSH.findHost<ItemSearchPanel>(this);\n\t\tconst repBy = me.repPtr.srcRef;\n\t\tif (!repBy) return;\n\t\tconst wedMgr = me.wedMgr;\n\t\tconst batch = wedMgr.docHolder.newBatch(wedMgr.getCurrentSel());\n\t\tconst annots = wedMgr.lastSkAnnots;\n\t\tlet lastAn: ISkSearchAnnot;\n\t\tfor (let i = annots.length - 1; i >= 0; i--) {\n\t\t\tconst an: ISkAnnot = annots[i];\n\t\t\tif (isSkSearchAnnot(an)) {\n\t\t\t\tconst start = XA.freeze(an.start);\n\t\t\t\tconst startWedlet = WEDLET.findWedlet(wedMgr.rootWedlet, start, {lastAncestorIfNone: true});\n\t\t\t\t//FIXME perms configuré sur wedlets, mais wedlets peut être non construit, passer perms sur schéma...\n\t\t\t\tif (startWedlet && WEDLET.resolveEditMode(startWedlet) === EWedletEditMode.write) batch.setAttr(start, repBy);\n\t\t\t\tif (!lastAn) lastAn = an;\n\t\t\t}\n\t\t}\n\t\tif (lastAn) {\n\t\t\tbatch.setSelAfter(lastAn.start);\n\t\t\tbatch.doBatch();\n\t\t} else {\n\t\t\tme.nav.gotoAnnot(1);\n\t\t}\n\t}\n\n\texecSearch() {\n\t\tif (!this.wedMgr) return;\n\t\tif (this.wedMgr.docHolder.setSkSearch(new SkItemSearch(this.findPtr.srcRef, this.action.maxResults)).length === 0) {\n\t\t\tthis.updateCount(0);\n\t\t}\n\t}\n\n\tconnectDoc(wedMgr: WedMgr): void {\n\t\tsuper.connectDoc(wedMgr);\n\t\tthis.findPtr.focus();\n\t}\n}\n\nfunction addAction(action: Action<IShortDescCtx>, accel?: string) {\n\tREG.reg.addToList(\"actions:wsp:wed:itemSearch\", action.getId(), 1, action);\n\tif (accel) REG.reg.addToList(\"accelkeys:wsp:wed:itemSearch\", accel, 1, action);\n}\n\naddAction(SrcPointerFastSelect.SINGLETON, \"Enter\");\naddAction(SrcPointerPaste.SINGLETON, \"v-accel\");\naddAction(new SrcPointerErase(), \"Delete\");\n\ncustomElements.define(\"wed-searchbar-item\", ItemSearchPanel);\n\n\n/**\n * Parcours des commentaires.\n */\nclass CommentSearchAction extends SearchBarPanelAction {\n\n\tconstructor(id?: string, maxResults?: number) {\n\t\tsuper(id || 'comment');\n\t\tthis.maxResults = maxResults || 300;\n\t\tthis._icon = \"/@skin@/edit/wed/search/commentSearch.svg\";\n\t\tthis._label = \"Parcourir les commentaires\";\n\t}\n\n\tbuildPanel(ctx: WedSearchBar, ev?: Event): ISearchBarPanel {\n\t\treturn new CommentSearchPanel().initPanel(this, ctx);\n\t}\n}\n\nREG.reg.addToList(\"wed.searchBar.actions\", \"comment\", 1, new CommentSearchAction(), 100);\n\nexport interface JCommentWedSearchBarParams extends JWedSearchBarParams {\n\topened?: boolean\n\tclosed?: boolean\n}\n\n/** */\nclass CommentSearchPanel extends SearchPanelBase {\n\taction: CommentSearchAction;\n\n\topened: HTMLInputElement;\n\tclosed: HTMLInputElement;\n\n\tinitPanel(action: CommentSearchAction, bar: WedSearchBar): this {\n\t\tthis._initPanel(action, bar, false);\n\t\tthis.opened = <input type=\"checkbox\" onchange={this.onChange} checked=\"\"/> as HTMLInputElement;\n\t\tthis.closed = <input type=\"checkbox\" onchange={this.onChange} checked=\"\"/> as HTMLInputElement;\n\t\tthis.shadowRoot.append(\n\t\t\tthis.nav,\n\t\t\t<div class=\"options\">\n\t\t\t\t<label>{this.opened}Ouverts</label>\n\t\t\t\t<label>{this.closed}Clos</label>\n\t\t\t</div>,\n\t\t\tthis.result\n\t\t);\n\t\treturn this;\n\t}\n\n\tsetSearch(params: JCommentWedSearchBarParams): void {\n\t\tif (typeof params.opened === \"boolean\") this.opened.checked = params.opened;\n\t\tif (typeof params.closed === \"boolean\") this.closed.checked = params.closed;\n\t\tthis.execSearch();\n\t}\n\n\tbuildSearch(): JCommentWedSearchBarParams {\n\t\treturn {\n\t\t\tsearchId: this.action.getId(),\n\t\t\topened: this.opened.checked,\n\t\t\tclosed: this.closed.checked\n\t\t}\n\t}\n\n\tprotected onChange(this: HTMLInputElement) {\n\t\tconst panel = DOMSH.findHost<CommentSearchPanel>(this);\n\t\tif (!panel.opened.checked && !panel.closed.checked) {\n\t\t\t//Les deux ne peuvent être décochés à la fois, on récative celui qui a été décoché.\n\t\t\tif (this === panel.opened) {\n\t\t\t\tpanel.closed.checked = true;\n\t\t\t} else {\n\t\t\t\tpanel.opened.checked = true;\n\t\t\t}\n\t\t}\n\t\tpanel.execSearch();\n\t\tDOMSH.findHost<WedSearchBar>(panel).dispatchSearchChange();\n\t}\n\n\texecSearch() {\n\t\tif (!this.wedMgr) return;\n\t\tif (this.wedMgr.docHolder.setSkSearch(new SkCommentSearch(this.opened.checked, this.closed.checked, this.action.maxResults)).length === 0) {\n\t\t\tthis.updateCount(0);\n\t\t}\n\t}\n}\n\ncustomElements.define(\"wed-searchbar-comment\", CommentSearchPanel);\n\n"]}