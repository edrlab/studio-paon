{"version":3,"sources":["/@back@/core/widgets/workbench.tsx"],"names":["BaseElement","BASIS","Tab","Tabs","LASTDATAS","REG","VIEWS","DOM","JSX","ShadowJsx","DOMSH","Resizer","POPUP","Action","ContextMenuDeskFeat","Workbench","tools","this","shadowRoot","querySelectorAll","[object Object]","r","tool","push","areas","areaId","tab","getTabByCode","selectTab","selected","unselectTab","init","reg","findReg","sr","attachShadow","SHADOWDOM_INIT","installSkin","_initAndInstallSkin","localName","areasContext","ctx","tbPrefix","toolbarsPrefix","lastDatas","ltT","getList","lbT","blT","brT","rtT","rbT","all","k","s","length","l","i","a","pos","getUserData","getId","allPos","splice","removeAndGet","area","layout","forbidInLayout","moveTo","target","aId","appendChild","createElement","id","c-resizable","class","title","onclick","onClosePan","WbTools","√Æ","Object","assign","orient","workbench","lt","c-orient","lb","rt","rb","bl","br","lastDatasKey","setAttribute","mw","getElementById","style","flexBasis","mh","lw","rw","bh","lth","lbh","blw","brw","rth","rbh","injectTabs","refreshSelectedTab","super","buildInitFromAtts","getAttribute","getLastDatas","p","d","offsetWidth","offsetHeight","_a","forcedTools","buildLastDatas","visitor","options","visible","closest","visitViews","undefined","visitViewsAsync","codeView","findTabView","parentViewCtn","view","parentElement","nextElementSibling","registerSkin","customElements","define","flapClosed","classList","contains","noArrowScroll","firstPos","secondPos","isVerticalPan","isFirstPan","isRightPan","add","_initialize","_areas","tabsBar","previousElementSibling","insertAdjacentElement","_tabs","_mainSlot","forEach","_newTab","res","_selectedTab","hide","silently","removeFromAreas","ok","closeTab","addTab","before","WbToolTab","initialize","showOnDragOver","insertBefore","setHidden","getPans","hasTabs","getPanResizer","siblingTools","getSiblingTools","selectedTab","panCollapsed","panSiblingCollapsed","getFlapResizer","disabled","setFlapClosed","getFlap","toggle","flex","getTabsCloseBtn","refresh","closed","tabs","getTabsBarClosed","setAttrBool","isLateralFlapCollapsed","bottomTools","getBottomTools","setAttr","flap","lastElementChild","findDocumentOrShadowRoot","ev","me","async","onSelPan","findPopupableParent","close","idx","indexOf","select","makeBtn","body","skin","isBottom","charAt","showFloating","posFrom","fromY","targetY","toleranceX","closeOnBlur","findHost","ctxMenuActions","actions","setLabel","_shown","setExecute","onMoveTab","actionContext","makeClickable","_createIcon","ondblclick","isIn","desk","showContextMenu","call","document","unlocated","unlocatedArea","located","create","show","_refresh","_iconElt","getDescription","getLabel"],"mappings":"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","sourcesContent":["import {BaseElement, BASIS, OSkinableInit} from \"back/commons/basis\";\nimport {JLDTabs, OTabInit, OTabsInit, Tab, Tabs} from \"back/commons/widgets/tabs\";\nimport {IArea} from \"lib/commons/areas\";\nimport {ILastDatasBuilder, JLastDatas, LASTDATAS, OLastDatasInit} from \"lib/commons/lastDatas\";\nimport {REG} from 'lib/commons/registry';\nimport {IView, IViewsContainer, OViewVisitOptions, VIEWS} from \"lib/commons/views\";\nimport {DOM, JSX, ShadowJsx} from \"lib/commons/xml/dom\";\nimport {DOMSH} from \"lib/commons/xml/domsh\";\nimport {Resizer} from \"back/commons/widgets/resizer\";\nimport {Button} from \"back/commons/widgets/buttons\";\nimport {POPUP} from \"back/commons/widgets/popups\";\nimport {IContextMenuActions, IContextMenuActionsPointer} from \"back/commons/actionables\";\nimport {Action} from \"lib/commons/actions\";\nimport {ContextMenuDeskFeat} from \"back/core/appFrame\";\n\n/**\n *\n * Attributs:\n * Config init att: toolbars-prefix\n * Config att: last-datas : key des lastDatas pour l'init et le build\n */\nexport interface Workbench<C> extends BaseElement {\n\tinitialize(init?: OWorkbenchInit<C>): this;\n}\n\nexport interface OWorkbenchInit<C = {}> extends OSkinableInit, OLastDatasInit {\n\tctx?: C;\n\n\t/**\n\t * Pr√©fixe des listes d'areas constituant les toolbars.\n\t * Exemple : \"myApp:\" d√©finit les listes \"myApp:tl\", \"myApp:tr\", \"myApp:lt\", \"myApp:lt\", \"myApp:rt\", \"myApp:rb\", \"myApp:bl\", \"myApp:br\"\n\t * DOIT √™tre sp√©cifi√©.\n\t */\n\ttoolbarsPrefix?: string\n\n\tlt?: OWbToolsInit<C>\n\tlb?: OWbToolsInit<C>\n\tbl?: OWbToolsInit<C>\n\tbr?: OWbToolsInit<C>\n\trt?: OWbToolsInit<C>\n\trb?: OWbToolsInit<C>\n}\n\nexport interface IWbToolArea<C = {}, E extends HTMLElement = HTMLElement> extends IArea<C, E> {\n\n\t/** Interdit d'ins√©rer cet Area dans un volet orient√© horizontalement ou verticalement. */\n\tforbidInLayout?: 'h' | 'v'\n}\n\n/** Wrap d'un IWbToolArea avec des indications sur le context graphique. */\nexport interface IWbToolLocatedArea<C = {}, E extends HTMLElement = HTMLElement> extends IWbToolArea<C, E> {\n\t/** area wrapp√©e non localis√©e. */\n\tunlocatedArea: IWbToolArea<C, E>\n\tlayout: 'h' | 'v'\n}\n\n/**\n * Vocabulaire :\n * - flap : volets gauche, droit et bas\n * - pan : panneau, zone d'affichage du contenu des views\n * - tabs : jeu d'onglets pour s√©lectionner le panneau avec le bouton de r√©duction de ces tabs et/ou de ces tabs.\n * - pans : regroupement du pan et de son tabs (pour le flap bas)\n */\nexport class Workbench<C> extends BaseElement implements IViewsContainer, ILastDatasBuilder {\n\n\tget tools(): NodeListOf<WbTools<C>> {return this.shadowRoot.querySelectorAll('c-wb-tools')}\n\n\tgetAreaTools(): IArea<C>[] {\n\t\tconst r = [] as IArea<C>[];\n\t\tfor (const tool of this.tools) r.push(...tool.areas);\n\t\treturn r;\n\t}\n\n\tshowAreaTool(areaId: string): Promise<boolean> | void {\n\t\tfor (const tool of this.tools) {\n\t\t\tconst tab = tool.getTabByCode(areaId);\n\t\t\tif (tab) return tool.selectTab(tab);\n\t\t}\n\t}\n\n\ttoggleAreaTool(areaId: string): Promise<boolean> | void {\n\t\tfor (const tool of this.tools) {\n\t\t\tconst tab = tool.getTabByCode(areaId);\n\t\t\tif (tab) return tab.selected ? tool.unselectTab() : tool.selectTab(tab);\n\t\t}\n\t}\n\n\n\tgetTab(areaId: string): Tab<C> | null {\n\t\tfor (const tool of this.tools) {\n\t\t\tconst tab = tool.getTabByCode(areaId);\n\t\t\tif (tab) return tab;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected _initialize(init: OWorkbenchInit<C>) {\n\t\tconst reg = this.findReg(init);\n\t\tconst sr = this.attachShadow(DOMSH.SHADOWDOM_INIT);\n\t\treg.installSkin('webzone:panel', sr);\n\t\tthis._initAndInstallSkin(this.localName, init);\n\n\t\tconst areasContext = init.ctx ? init.ctx : this;\n\t\tconst tbPrefix = init.toolbarsPrefix;\n\t\tconst lastDatas = init.lastDatas as JLDWorkbench;\n\n\t\tconst ltT: IWbToolArea[] = reg.getList(tbPrefix + 'lt') || [];\n\t\tconst lbT: IWbToolArea[] = reg.getList(tbPrefix + 'lb') || [];\n\t\tconst blT: IWbToolArea[] = reg.getList(tbPrefix + 'bl') || [];\n\t\tconst brT: IWbToolArea[] = reg.getList(tbPrefix + 'br') || [];\n\t\tconst rtT: IWbToolArea[] = reg.getList(tbPrefix + 'rt') || [];\n\t\tconst rbT: IWbToolArea[] = reg.getList(tbPrefix + 'rb') || [];\n\n\t\tconst all = [ltT, lbT, blT, brT, rtT, rbT];\n\n\t\t//Replacement des tools par les userPrefs\n\t\tfor (let k = 0, s=all.length; k<s; k++) {\n\t\t\tconst l = all[k];\n\t\t\tfor (let i = l.length - 1; i >= 0; i--) {\n\t\t\t\tconst a = l[i];\n\t\t\t\tif (a) {\n\t\t\t\t\tconst pos = reg.getUserData(tbPrefix + a.getId());\n\t\t\t\t\tif(pos && pos !== allPos[k]) {\n\t\t\t\t\t\t//On d√©place a vers pos\n\t\t\t\t\t\tswitch(pos){\n\t\t\t\t\t\tcase 'lt': ltT.push(a); break;\n\t\t\t\t\t\tcase 'lb': lbT.push(a); break;\n\t\t\t\t\t\tcase 'bl': blT.push(a); break;\n\t\t\t\t\t\tcase 'br': brT.push(a); break;\n\t\t\t\t\t\tcase 'rt': rtT.push(a); break;\n\t\t\t\t\t\tcase 'rb': rbT.push(a); break;\n\t\t\t\t\t\tdefault: continue; //pos pas trouv√©, on passe.\n\t\t\t\t\t\t}\n\t\t\t\t\t\tl.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (lastDatas) {\n\t\t\t//Replacement des tools par les lastDatas\n\t\t\tfunction removeAndGet(area: string, layout: 'h' | 'v'): IWbToolArea | null {\n\t\t\t\tfor (const l of all) {\n\t\t\t\t\tfor (let i = l.length - 1; i >= 0; i--) {\n\t\t\t\t\t\tconst a = l[i];\n\t\t\t\t\t\tif (a?.getId() === area && a.forbidInLayout !== layout) {\n\t\t\t\t\t\t\t//Area trouv√© et target layout compatible.\n\t\t\t\t\t\t\tl.splice(i, 1);\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction moveTo(areas: string[], target: IWbToolArea[], layout: 'h' | 'v') {\n\t\t\t\tif (!areas) return;\n\t\t\t\tfor (const aId of areas) {\n\t\t\t\t\tconst a = removeAndGet(aId, layout);\n\t\t\t\t\tif (a) target.push(a);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tmoveTo(lastDatas.ltT, ltT, 'v');\n\t\t\tmoveTo(lastDatas.lbT, lbT, 'v');\n\t\t\tmoveTo(lastDatas.rtT, rtT, 'v');\n\t\t\tmoveTo(lastDatas.rbT, rbT, 'v');\n\t\t\tmoveTo(lastDatas.blT, blT, 'h');\n\t\t\tmoveTo(lastDatas.brT, brT, 'h');\n\t\t}\n\n\t\tsr.appendChild(\n\t\t\t<div id=\"mid\" c-resizable=\"\">\n\t\t\t\t<div id=\"flapL\" c-resizable=\"\">\n\t\t\t\t\t<did id=\"pansLT\" class=\"pans\" c-resizable=\"\">\n\t\t\t\t\t\t<div id=\"tabsLT\" class=\"tabs\">\n\t\t\t\t\t\t\t<button id=\"closeLT\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<WbTools √Æ={Object.assign({orient: 'lt', areas: ltT, areasContext, lastDatas, workbench: this}, init.lt)}/>\n\t\t\t\t\t</did>\n\t\t\t\t\t<Resizer class=\"pansSep\" c-orient=\"column\"/>\n\t\t\t\t\t<did id=\"pansLB\" class=\"pans\" c-resizable=\"\">\n\t\t\t\t\t\t<div id=\"tabsLB\" class=\"tabs\">\n\t\t\t\t\t\t\t<button id=\"closeLB\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<WbTools √Æ={Object.assign({orient: 'lb', areas: lbT, areasContext, lastDatas, workbench: this}, init.lb)}/>\n\t\t\t\t\t</did>\n\t\t\t\t\t<div id=\"bTabsL\" class=\"bTabs\"/>\n\t\t\t\t</div>\n\t\t\t\t<Resizer c-orient=\"row\"/>\n\t\t\t\t<div id=\"main\" c-resizable=\"\">\n\t\t\t\t\t<slot/>\n\t\t\t\t</div>\n\t\t\t\t<Resizer c-orient=\"row\"/>\n\t\t\t\t<div id=\"flapR\" c-resizable=\"\">\n\t\t\t\t\t<did id=\"pansRT\" class=\"pans pansH\" c-resizable=\"\">\n\t\t\t\t\t\t<div id=\"tabsRT\" class=\"tabs\">\n\t\t\t\t\t\t\t<button id=\"closeRT\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<WbTools √Æ={Object.assign({orient: 'rt', areas: rtT, areasContext, lastDatas, workbench: this}, init.rt)}/>\n\t\t\t\t\t</did>\n\t\t\t\t\t<Resizer class=\"pansSep\" c-orient=\"column\"/>\n\t\t\t\t\t<did id=\"pansRB\" class=\"pans pansH\" c-resizable=\"\">\n\t\t\t\t\t\t<div id=\"tabsRB\" class=\"tabs\">\n\t\t\t\t\t\t\t<button id=\"closeRB\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<WbTools √Æ={Object.assign({orient: 'rb', areas: rbT, areasContext, lastDatas, workbench: this}, init.rb)}/>\n\t\t\t\t\t</did>\n\t\t\t\t\t<div id=\"bTabsR\" class=\"bTabs\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\n\t\tsr.appendChild(<Resizer class=\"sep\" c-orient=\"column\"/>);\n\t\tsr.appendChild(<div id=\"flapB\" c-resizable=\"\">\n\t\t\t<div id=\"pansBL\" class=\"pans\" c-resizable=\"\">\n\t\t\t\t<div id=\"tabsBL\" class=\"tabs\">\n\t\t\t\t\t<button id=\"closeBL\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t</div>\n\t\t\t\t<WbTools √Æ={Object.assign({orient: 'bl', areas: blT, areasContext, lastDatas, workbench: this}, init.bl)}/>\n\t\t\t</div>\n\t\t\t<Resizer class=\"pansSep\" c-orient=\"row\"/>\n\t\t\t<div id=\"pansBR\" class=\"pans\" c-resizable=\"\">\n\t\t\t\t<div id=\"tabsBR\" class=\"tabs\">\n\t\t\t\t\t<button id=\"closeBR\" title=\"Refermer ce volet\" onclick={this.onClosePan}/>\n\t\t\t\t</div>\n\t\t\t\t<WbTools √Æ={Object.assign({orient: 'br', areas: brT, areasContext, lastDatas, workbench: this}, init.br)}/>\n\t\t\t</div>\n\t\t</div>);\n\n\t\t//LastDatas\n\t\tif (init.lastDatasKey) this.setAttribute(\"last-datas\", init.lastDatasKey);\n\t\tif (lastDatas) {\n\t\t\tif (lastDatas.mw > 0) sr.getElementById(\"main\").style.flexBasis = lastDatas.mw + \"px\";\n\t\t\tif (lastDatas.mh > 0) sr.getElementById(\"mid\").style.flexBasis = lastDatas.mh + \"px\";\n\t\t\tif (lastDatas.lw > 0) sr.getElementById(\"flapL\").style.flexBasis = lastDatas.lw + \"px\";\n\t\t\tif (lastDatas.rw > 0) sr.getElementById(\"flapR\").style.flexBasis = lastDatas.rw + \"px\";\n\t\t\tif (lastDatas.bh > 0) sr.getElementById(\"flapB\").style.flexBasis = lastDatas.bh + \"px\";\n\t\t\tif (lastDatas.lth) sr.getElementById(\"pansLT\").style.flexBasis = lastDatas.lth;\n\t\t\tif (lastDatas.lbh) sr.getElementById(\"pansLB\").style.flexBasis = lastDatas.lbh;\n\t\t\tif (lastDatas.blw) sr.getElementById(\"pansBL\").style.flexBasis = lastDatas.blw;\n\t\t\tif (lastDatas.brw) sr.getElementById(\"pansBR\").style.flexBasis = lastDatas.brw;\n\t\t\tif (lastDatas.rth) sr.getElementById(\"pansRT\").style.flexBasis = lastDatas.rth;\n\t\t\tif (lastDatas.rbh) sr.getElementById(\"pansRB\").style.flexBasis = lastDatas.rbh;\n\t\t}\n\t\tfor (const tools of this.tools) tools.injectTabs();\n\t\tfor (const tools of this.tools) tools.refreshSelectedTab();\n\t}\n\n\tbuildInitFromAtts(init?: OWorkbenchInit<C>): OWorkbenchInit<C> {\n\t\tinit = super.buildInitFromAtts(init);\n\t\tinit.toolbarsPrefix = this.getAttribute(\"toolbars-prefix\");\n\t\tinit.lastDatas = LASTDATAS.getLastDatas(this, this.getAttribute(\"last-datas\"));\n\t\treturn init;\n\t}\n\n\tbuildLastDatas(p: JLastDatas) {\n\t\tconst k = this.getAttribute(\"last-datas\");\n\t\tif (k) {\n\t\t\tconst d = p[k] = {} as JLDWorkbench;\n\t\t\tconst sr = this.shadowRoot;\n\t\t\td.mw = sr.getElementById(\"main\").offsetWidth;\n\t\t\td.mh = sr.getElementById(\"mid\").offsetHeight;\n\t\t\td.lw = sr.getElementById(\"flapL\").offsetWidth;\n\t\t\td.rw = sr.getElementById(\"flapR\").offsetWidth;\n\t\t\td.bh = sr.getElementById(\"flapB\").offsetHeight;\n\t\t\td.lth = sr.getElementById(\"pansLT\").style.flexBasis;\n\t\t\td.lbh = sr.getElementById(\"pansLB\").style.flexBasis;\n\t\t\td.blw = sr.getElementById(\"pansBL\").style.flexBasis;\n\t\t\td.brw = sr.getElementById(\"pansBR\").style.flexBasis;\n\t\t\td.rth = sr.getElementById(\"pansRT\").style.flexBasis;\n\t\t\td.rbh = sr.getElementById(\"pansRB\").style.flexBasis;\n\t\t\tfor (const tools of this.tools) {\n\t\t\t\tif (tools.forcedTools?.length > 0) (d as any)[tools.id + \"T\"] = tools.forcedTools;\n\t\t\t\ttools.buildLastDatas(d);\n\t\t\t\t//else d[tools.id as 'lt' | 'lb' | 'rt' | 'rb' | 'bl' | 'br'] = null\n\t\t\t}\n\t\t}\n\t\t//on poursuit dans le contenu principal\n\t\tLASTDATAS.buildLastDatas(p, this);\n\t}\n\n\tvisitViews(visitor: (view: IView) => any, options?: OViewVisitOptions) {\n\t\tfor (const tools of this.tools) {\n\t\t\tif (!options || !options.visible || !tools.closest('[hidden]')) {\n\t\t\t\tconst r = tools.visitViews(visitor, options);\n\t\t\t\tif (r !== undefined) return r;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync visitViewsAsync(visitor: (view: IView) => Promise<any>, options?: OViewVisitOptions): Promise<any> {\n\t\tfor (const tools of this.tools) {\n\t\t\tif (!options || !options.visible || !tools.closest('[hidden]')) {\n\t\t\t\tconst r = await tools.visitViewsAsync(visitor, options);\n\t\t\t\tif (r !== undefined) return r;\n\t\t\t}\n\t\t}\n\t}\n\n\tfindTabView(codeView: string): Tab {\n\t\tfor (const tools of this.tools) {\n\t\t\tconst tab = tools.getTabByCode(codeView);\n\t\t\tif (tab) return tab;\n\t\t}\n\t\treturn null;\n\t}\n\n\tasync showView(codeView: string): Promise<IView> {\n\t\tconst tab = this.findTabView(codeView);\n\t\tif (tab && await tab.parentViewCtn.selectTab(tab)) return tab.view;\n\t\treturn null;\n\t}\n\n\tonClosePan(this: Button) {\n\t\t(this.parentElement.nextElementSibling as WbTools<C>).unselectTab();\n\t}\n}\n\ninterface JLDWorkbench {\n\t//Tailles\n\tmw?: number\n\tmh?: number\n\tlw?: number\n\trw?: number\n\tth?: number\n\tbh?: number\n\tlth?: string\n\tlbh?: string\n\tblw?: string\n\tbrw?: string\n\trth?: string\n\trbh?: string\n\t//D√©placements\n\tltT?: string[]\n\tlbT?: string[]\n\tblT?: string[]\n\tbrT?: string[]\n\trtT?: string[]\n\trbT?: string[]\n\t//SubLastDatas\n\tmain?: JLastDatas\n\tlt?: JLastDatas\n\tlb?: JLastDatas\n\trt?: JLastDatas\n\trb?: JLastDatas\n\tbl?: JLastDatas\n\tbr?: JLastDatas\n}\n\nREG.reg.registerSkin('c-workbench', 1, /* language=CSS */ `\n\t:host {\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: column;\n\t\tflex: 1;\n\t\tpadding: 5px;\n\t\tbackground-color: inherit; /*contre webzone:panel*/\n\t}\n\n\t#mid {\n\t\tflex: 5 5 60vh;\n\t\tdisplay: flex;\n\t\tmin-height: 10%;\n\t\tmin-width: 0;\n\t\toverflow: hidden;\n\t}\n\n\t#main {\n\t\tflex: 5 5 60vw;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 10%;\n\t\tflex-direction: column;\n\t\toverflow: auto;\n\t\tborder: 1px solid var(--page-border-color);\n\t\tborder-radius: 7px;\n\t}\n\n\t[hidden] {\n\t\tdisplay: none !important;\n\t}\n\n\t#flapB {\n\t\tflex: 1 1 20vh;\n\t\tdisplay: flex;\n\t\tmin-width: 0;\n\t\tmin-height: 5em;\n\t\tflex-direction: row;\n\t}\n\n\t#flapL,\n\t#flapR {\n\t\tflex: 1 1 20vw;\n\t\tdisplay: flex;\n\t\tmin-width: 5em;\n\t\tmin-height: 0;\n\t\tflex-direction: column;\n\t}\n\n\t#flapL.closed,\n\t#flapR.closed,\n\t#flapB.closed {\n\t\tflex: 0 0 auto;\n\t\tmin-width: 0;\n\t\tmin-height: 0;\n\t}\n\n\t:host(.hideFlapTabs) > * > #flapL.closed,\n\t:host(.hideFlapTabs) > * > #flapR.closed,\n\t:host(.hideFlapTabs) > #flapB.closed,\n\t:host(.hideFlapTabs) .pans[pan-state='collapsed'],\n\t:host(.hideFlapTabs) .tabs.collapsed,\n\t:host(.hideFlapTabs) .pansSep[disabled] {\n\t\tdisplay: none !important;\n\t}\n\n\t.panV {\n\t\tflex: 1 1 15vh;\n\t\tdisplay: flex;\n\t\tmin-width: 3em;\n\t\tmin-height: 0;\n\t\tflex-direction: column;\n\t}\n\n\t.panH {\n\t\tdisplay: flex;\n\t\tmin-height: 3em;\n\t\tmin-width: 0;\n\t\tflex-direction: row;\n\t}\n\n\t.pans {\n\t\tflex: 1 1 50%;\n\t\tdisplay: flex;\n\t\tmin-width: 0;\n\t\tmin-height: 0;\n\t\tflex-direction: column;\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 7px;\n\t\toverflow: hidden;\n\t}\n\n\t.pans[pan-state='closed'],\n\t.pansH[pan-state='collapsed'] {\n\t\tflex: 1 1 50%;\n\t\tborder: none;\n\t\tbox-shadow: unset;\n\t}\n\n\t[pan-state='closed'] > .tabs,\n\t.bTabs > .tabs,\n\t.pansH[pan-state='collapsed'] > .tabs {\n\t\tborder: 1px solid var(--border-color);\n\t}\n\n\t.pans[pan-state='collapsed'] {\n\t\tflex: 0 0 auto;\n\t}\n\n\t.bTabs > .tabs {\n\t\tmargin-top: 5px;\n\t}\n\n\t#pansBL[pan-state='collapsed'],\n\t#pansBR[pan-state='collapsed'] {\n\t\talign-self: flex-end;\n\t}\n\n\t.tabs.collapsed {\n\t\tborder-radius: 7px;\n\t}\n\n\tc-wb-tools {\n\t\tflex: 1;\n\t\tborder-top: 1px solid var(--border-color);\n\t\tbackground-color: var(--bgcolor);\n\t}\n\n\tc-resizer {\n\t\tbackground-color: transparent;\n\t}\n\n\tc-resizer[c-orient=row] {\n\t\twidth: 5px;\n\t}\n\n\tc-resizer[c-orient=column] {\n\t\theight: 5px;\n\t}\n\n\t.tabs {\n\t\tbackground-color: var(--page-bgcolor);\n\t}\n\n\t#tabsLT, #tabsLB, #tabsBL {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t}\n\n\t#tabsRT, #tabsRB, #tabsBR {\n\t\tdisplay: flex;\n\t\tflex-direction: row-reverse;\n\t\talign-items: center;\n\t}\n\n\tc-oriented-box {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t}\n\n\tc-oriented-box[vertical] {\n\t\tflex: 1 1 auto;\n\t\tflex-direction: column;\n\t}\n\n\tc-wb-tooltab {\n\t\tflex: 1 1 auto;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\toverflow: hidden;\n\t\talign-items: center;\n\t\t/*justify-content: center;*/\n\t\tpadding: .2em;\n\t\tcursor: pointer;\n\t\tuser-select: none;\n\t}\n\n\t:not([vertical]) > c-wb-tooltab:not(:first-child) {\n\t\tborder-inline-start: 1px solid var(--border-color);\n\t}\n\n\t[vertical] > c-wb-tooltab:not(:first-child) {\n\t\tborder-block-start: 1px solid var(--border-color);\n\t}\n\n\t:not(.collapsed) > * > c-wb-tooltab {\n\t\tbackground: var(--item-bgcolor);\n\t}\n\n\n\tc-wb-tooltab:hover, c-wb-tooltab.willBeShown {\n\t\tbackground: var(--pressed-bgcolor);\n\t}\n\n\tc-wb-tooltab.moved {\n\t\tz-index: 1;\n\t}\n\n\tc-wb-tooltab.selected {\n\t\t/*z-index: 1;*/\n\t\tbackground: var(--page-bgcolor);\n\t\tcursor: default;\n\t}\n\n\tc-wb-tooltab:not(.moved) {\n\t\ttransition: top 0.2s linear, left 0.2s linear;\n\t}\n\n\tc-wb-tooltab:focus {\n\t\toutline: var(--focus-outline);\n\t\toutline-offset: -2px;\n\t}\n\n\tc-wb-tooltab > .icon {\n\t\theight: var(--icon-size);\n\t\twidth: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t\tmin-width: var(--icon-size);\n\t\tbackground: var(--icon-img) no-repeat center / contain;\n\t\tfilter: var(--filter);\n\t\tmargin: 1px;\n\t}\n\n\tc-wb-tooltab > .label {\n\t\twhite-space: pre;\n\t}\n\n\t/*[pan-state=\"closed\"] > * > * > c-wb-tooltab > .label {display: none;}*/\n\t[vertical] > c-wb-tooltab > .label {\n\t\tdisplay: none;\n\t}\n\n\tbutton {\n\t\tappearance: none;\n\t\tbackground: no-repeat center / contain;\n\t\tborder: 3px solid transparent;\n\t\talign-self: stretch;\n\t\tcursor: pointer;\n\t\tfilter: var(--filter);\n\t}\n\n\tbutton:hover {\n\t\tbackground-color: var(--pressed-bgcolor);\n\t}\n\n\tbutton:focus {\n\t\toutline: var(--focus-outline);\n\t\toutline-offset: -2px;\n\t}\n\n\t.collapsed > button {\n\t\tdisplay: none;\n\t}\n\n\t#tabsLT > button,\n\t#tabsLB > button,\n\t#tabsBL > button.sibling {\n\t\tbackground-image: url('/@skin@/core/widgets/workbench/closeToolL.svg');\n\t\tmin-width: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t}\n\n\t#tabsRT > button,\n\t#tabsRB > button,\n\t#tabsBR > button.sibling {\n\t\tbackground-image: url('/@skin@/core/widgets/workbench/closeToolR.svg');\n\t\tmin-width: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t}\n\n\t#tabsLT > button.sibling,\n\t#tabsRT > button.sibling {\n\t\tbackground-image: url('/@skin@/core/widgets/workbench/closeToolT.svg');\n\t\tmin-width: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t}\n\n\t#tabsBL > button,\n\t#tabsBR > button,\n\t#tabsLB > button.sibling,\n\t#tabsRB > button.sibling {\n\t\tbackground-image: url('/@skin@/core/widgets/workbench/closeToolB.svg');\n\t\tmin-width: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t}\n\n\t:host(.hideFlapTabs) .tabs > button {\n\t\tbackground-image: url('/@skin@/core/widgets/workbench/closeTool.svg') !important;\n\t\tmin-width: var(--icon-size);\n\t\tmin-height: var(--icon-size);\n\t}\n`);\n\n\ncustomElements.define('c-workbench', Workbench);\n\ninterface OWbToolsInit<C> extends OTabsInit<C> {\n\torient?: 'lt' | 'lb' | 'rt' | 'rb' | 'bl' | 'br'\n\tvertical?: never\n\tlastDatas?: JLDWorkbench | JLDTabs //init via JLDWorkbench r√©solu en JLDTabs\n\tworkbench?: Workbench<C>\n}\n\nclass WbTools<C> extends Tabs<C> {\n\n\tforcedTools?: string[]\n\n\t/** Ce pan est-il vertical (lt, lb, rt, rb) ou horizontal (bl, br) ? */\n\tisVerticalPan: boolean\n\n\t/** Ce pan est-il le premier dans le flap (lt, rt, bk) */\n\tisFirstPan: boolean\n\n\t/** Ce pan est-il √† droite (rt, rb, br) */\n\tisRightPan: boolean\n\n\ttabsBar: HTMLDivElement;\n\n\tget flapClosed(): boolean {return this.classList.contains(\"flapClosed\")}\n\n\tprotected async _initialize(init: OWbToolsInit<C>): Promise<void> {\n\t\tinit.noArrowScroll = true;\n\t\tthis.id = init.orient;\n\t\tconst firstPos = this.id[0];\n\t\tconst secondPos = this.id[1];\n\t\tthis.isVerticalPan = firstPos !== 'b';\n\t\tthis.isFirstPan = secondPos === 't' || secondPos === 'l';\n\t\tthis.isRightPan = this.isVerticalPan ? firstPos === 'r' : secondPos === 'r';\n\n\t\tthis.classList.add(this.isVerticalPan ? \"panV\" : \"panH\");\n\t\tif (init.lastDatas) {\n\t\t\tthis.forcedTools = (init.lastDatas as any)[init.orient + \"T\"] as string[];\n\t\t\tinit.lastDatas = (init.lastDatas as JLDWorkbench)[init.orient] as JLDTabs;\n\t\t}\n\t\tthis.setAttribute(\"last-datas\", init.orient);\n\t\tawait super._initialize(init);\n\t\tif (!this._areas) this._areas = [];\n\t}\n\n\tprotected _initSkins(init: OTabsInit<C>) {\n\t}\n\n\t/** Finalise l'init avec le placement des tabs pour ce pan. */\n\tinjectTabs() {\n\t\tthis.tabsBar = this.previousElementSibling as HTMLDivElement;\n\t\tthis.tabsBar.insertAdjacentElement(\"afterbegin\", this._tabs);\n\t}\n\n\t_initShadowRoot() {\n\t\tthis.shadowRoot.appendChild(this._mainSlot);\n\t}\n\n\n\t_initTabs() {\n\t\tthis._areas?.forEach((area: IArea<C>) => {this._newTab(area)});\n\t}\n\n\tasync selectTab(tab: Tab<C>, lastDatas?: JLastDatas): Promise<boolean> {\n\t\tif (tab == null) return this.unselectTab();\n\t\tconst res = await super.selectTab(tab, lastDatas);\n\t\tthis.refreshSelectedTab();\n\t\treturn res;\n\t}\n\n\tasync unselectTab(): Promise<boolean> {\n\t\tif (!this._selectedTab) return false;\n\t\tif (!await this._selectedTab.hide()) return false;\n\t\tthis._selectedTab = null;\n\t\tthis.refreshSelectedTab();\n\t\treturn true;\n\t}\n\n\tasync closeTab(tab: Tab<C>, silently?: boolean, removeFromAreas?: boolean): Promise<boolean> {\n\t\tconst ok = await super.closeTab(tab, silently, removeFromAreas);\n\t\tif (ok) this.refreshSelectedTab();\n\t\treturn ok;\n\t}\n\n\tasync addTab(area: IArea<C>, options?: { select?: boolean; position?: number; view?: IView }): Promise<void> {\n\t\tawait super.addTab(area, options);\n\t\tthis.refreshSelectedTab();\n\t}\n\n\t_newTab(area: IArea<C>, before?: Tab<C>, view?: IView): Tab<C> {\n\t\tconst tab = new WbToolTab<C>().initialize({\n\t\t\tparentViewCtn: this,\n\t\t\tarea,\n\t\t\tview\n\t\t});\n\t\ttab.onclick = function (this: WbToolTab<C>) {\n\t\t\tthis.parentViewCtn.selectTab(this);\n\t\t};\n\t\ttab.showOnDragOver = true;\n\t\tthis._tabs.insertBefore(tab, before);\n\t\treturn tab;\n\t}\n\n\trefreshSelectedTab() {\n\t\tif (DOM.setHidden(this.getPans(), !this.hasTabs())) {\n\t\t\tDOM.setHidden(this.getPanResizer(), !this.hasTabs())\n\t\t}\n\n\t\tconst siblingTools = this.getSiblingTools();\n\t\tconst flapClosed: boolean = !this._selectedTab && !siblingTools.selectedTab;\n\t\tconst panCollapsed = !this._selectedTab;\n\t\tconst panSiblingCollapsed = !siblingTools.selectedTab;\n\n\t\tthis.getFlapResizer().disabled = flapClosed;\n\t\tthis.setFlapClosed(flapClosed, panCollapsed, panSiblingCollapsed);\n\t\tsiblingTools.setFlapClosed(flapClosed, panSiblingCollapsed, panCollapsed);\n\t\tthis.getFlap().classList.toggle(\"closed\", flapClosed);\n\t\tif (flapClosed) this.getFlap().style.flex = \"\"; //reset Resizer\n\t\tthis.tabsBar.classList.toggle(\"collapsed\", panCollapsed);\n\t\tif (DOM.setHidden(this, panCollapsed) && panCollapsed) this.getPans().style.flex = \"\"; //reset Resizer\n\t\tthis.getPanResizer().disabled = panCollapsed || panSiblingCollapsed;\n\n\t\tif (!panCollapsed) this.getTabsCloseBtn().classList.toggle(\"sibling\", !panSiblingCollapsed);\n\t\tif (!panSiblingCollapsed) siblingTools.getTabsCloseBtn().classList.toggle(\"sibling\", !panCollapsed);\n\n\t\tthis.refresh();\n\t\tsiblingTools.refresh();\n\t}\n\n\t/** Ajustement du pan et de ses tabs en fonction de l'√©tat ouvert/ferm√© de son flap */\n\tprotected setFlapClosed(closed: boolean, panCollapsed: boolean, panSiblingCollapsed: boolean) {\n\t\tthis.classList.toggle(\"flapClosed\", closed);\n\t\tif (!this.isVerticalPan) {\n\t\t\t//flap bas, on place les tabs dans le bon container\n\t\t\tconst tabs = this.tabsBar;\n\t\t\tif (closed) {\n\t\t\t\tif (tabs.parentElement === this.parentElement) this.getTabsBarClosed().appendChild(tabs);\n\t\t\t} else {\n\t\t\t\tif (tabs.parentElement !== this.parentElement) this.insertAdjacentElement(\"beforebegin\", tabs);\n\t\t\t}\n\t\t}\n\t\tif (!this.isVerticalPan) {\n\t\t\t//Flap bas\n\t\t\tDOM.setAttrBool(this, 'vertical', panCollapsed && (this.isLateralFlapCollapsed() || !panSiblingCollapsed));\n\t\t} else {\n\t\t\t//Flap lat√©ral,\n\t\t\tDOM.setAttrBool(this, 'vertical', closed);\n\t\t\t//on ajuste notre flap bas\n\t\t\tconst bottomTools = this.getBottomTools();\n\t\t\tif (DOM.setAttrBool(bottomTools, 'vertical', !bottomTools.selectedTab && (panCollapsed && panSiblingCollapsed || !!bottomTools.getSiblingTools().selectedTab))) bottomTools.refresh();\n\t\t}\n\n\t\tif (closed) this.getPans().style.flex = \"\"; //reset Resizer\n\t\tDOM.setAttr(this.getPans(), \"pan-state\", closed ? \"closed\" : !this._selectedTab ? \"collapsed\" : \"opened\");\n\t}\n\n\tgetPans(): HTMLElement {\n\t\treturn this.parentElement;\n\t}\n\n\tgetFlap(): HTMLElement {\n\t\treturn this.parentElement.parentElement;\n\t}\n\n\tgetFlapResizer(): Resizer {\n\t\tconst flap = this.getFlap();\n\t\tif (flap.id === \"flapL\") return flap.nextElementSibling as Resizer;\n\t\treturn flap.previousElementSibling as Resizer; //flapR et flapB\n\t}\n\n\tgetPanResizer(): Resizer {\n\t\t//if (this.isVerticalPan) return (this.isFirstPan ? this.nextElementSibling : this.previousElementSibling.previousElementSibling) as Resizer;\n\t\treturn (this.isFirstPan ? this.parentElement.nextElementSibling : this.parentElement.previousElementSibling) as Resizer;\n\t}\n\n\tgetTabsCloseBtn(): HTMLButtonElement {\n\t\treturn this.tabsBar.lastElementChild as HTMLButtonElement;\n\t}\n\n\t/** Onglets referm√©s des pans en bas */\n\tgetTabsBarClosed(): HTMLDivElement {\n\t\treturn DOMSH.findDocumentOrShadowRoot(this).getElementById(this.isRightPan ? \"bTabsR\" : \"bTabsL\") as HTMLDivElement;\n\t}\n\n\tgetSiblingTools(): WbTools<C> {\n\t\t//if (this.isVerticalPan) return (this.isFirstPan ? this.nextElementSibling.nextElementSibling.nextElementSibling : this.previousElementSibling.previousElementSibling.previousElementSibling) as WbTools<C>;\n\t\treturn (this.isFirstPan ? this.parentElement.nextElementSibling.nextElementSibling.lastElementChild : this.parentElement.previousElementSibling.previousElementSibling.lastElementChild) as WbTools<C>;\n\t}\n\n\tgetBottomTools(): WbTools<C> {\n\t\treturn DOMSH.findDocumentOrShadowRoot(this).getElementById(this.isRightPan ? \"br\" : \"bl\") as WbTools<C>;\n\t}\n\n\tisLateralFlapCollapsed() {\n\t\treturn DOMSH.findDocumentOrShadowRoot(this).getElementById(this.isRightPan ? \"flapR\" : \"flapL\").classList.contains(\"closed\");\n\t}\n\n\tonMoveTab(tab: WbToolTab<C>, ev: Event) {\n\t\tconst me = this;\n\n\t\tasync function onSelPan(this: HTMLButtonElement, ev: Event) {\n\t\t\tPOPUP.findPopupableParent(this).close();\n\t\t\tconst area = tab.area;\n\t\t\tconst target = DOMSH.findDocumentOrShadowRoot(me).getElementById(this.id) as WbTools<C>;\n\t\t\tawait me.unselectTab();\n\t\t\tif (await me.closeTab(tab, false, true)) {\n\t\t\t\tconst idx = me.forcedTools?.indexOf(area.getId());\n\t\t\t\tif (idx >= 0) me.forcedTools.splice(idx, 1);\n\t\t\t\t(target.forcedTools || (target.forcedTools = [])).push(area.getId());\n\t\t\t\tawait target.addTab(area, {select: true});\n\t\t\t}\n\t\t}\n\n\t\tfunction makeBtn(id: string, layout: 'h' | 'v') {\n\t\t\treturn <button id={id} onclick={onSelPan} class={me.id === id ? 'current' : undefined} disabled={me.id === id || (tab.area as IWbToolArea).forbidInLayout === layout ? \"\" : undefined} style={\"grid-area:\" + id}/>\n\t\t}\n\n\t\tconst body = <div><ShadowJsx skin=\"c-wb-tools/movePopup\">\n\t\t\t{makeBtn(\"lt\", 'v')}\n\t\t\t{makeBtn(\"lb\", 'v')}\n\t\t\t<div id=\"central\">S√©lectionnez un des volets disponibles</div>\n\t\t\t{makeBtn(\"rt\", 'v')}\n\t\t\t{makeBtn(\"rb\", 'v')}\n\t\t\t{makeBtn(\"bl\", 'h')}\n\t\t\t{makeBtn(\"br\", 'h')}\n\t\t</ShadowJsx></div>;\n\t\tconst isBottom = me.id.charAt(0) === 'b';\n\t\tPOPUP.showFloating(body, {posFrom: ev.target as HTMLElement, fromY: isBottom ? \"top\" : \"bottom\", targetY: isBottom ? \"bottom\" : \"top\", toleranceX: 500}, this, {closeOnBlur: true});\n\t}\n\n\t_onClose(this: Button, ev: Event) {\n\t\tDOMSH.findHost<WbTools<C>>(this).unselectTab();\n\t}\n}\n\nREG.reg.registerSkin('c-wb-tools/movePopup', 1, /* language=CSS */ `\n\t:host {\n\t\tdisplay: grid;\n\t\tgrid-template: \n\t\t\t\"lt m  m  rt\" 2fr\n\t\t\t\"lb m  m  rb\" 2fr\n\t\t\t\"bl bl br br\" 1fr / 1fr 1fr 1fr 1fr;\n\t\twidth: 12em;\n\t\theight: 12em;\n\t\tbackground-color: var(--border-color);\n\t}\n\n\t#central {\n\t\tgrid-area: m;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttext-align: center;\n\t}\n\n\tbutton {\n\t\tbackground-color: var(--panel-bgcolor);\n\t\tborder: 1px solid var(--panel-border-color);\n\t\tcursor: pointer;\n\t}\n\n\t.current {\n\t\tbackground-color: var(--panel-row-inSel-bgcolor) !important;\n\t}\n\n\tbutton:not([disabled]):hover {\n\t\tbackground-color: var(--panel-tabf-bgcolor);\n\t}\n\n\tbutton[disabled] {\n\t\tbackground-color: #88888855;\n\t\tcursor: auto;\n\t}\n\n\tbutton[disabled]::before {\n\t\tcontent: 'üõá';\n\t\tfont-size: .8rem;\n\t\tcolor: var(--panel-color);\n\t}\n\n\t.v {\n\t\tmin-width: 1em;\n\t\tmin-height: 2em;\n\t}\n\n\t.h {\n\t\tmin-width: 2em;\n\t\tmin-height: 1em;\n\t}\n`);\n\ncustomElements.define('c-wb-tools', WbTools);\n\nclass WbToolTab<C> extends Tab<C> implements IContextMenuActionsPointer<WbToolTab<C>> {\n\n\tparentViewCtn: WbTools<C>;\n\n\tctxMenuActions: IContextMenuActions<WbToolTab<C>> = {\n\t\tactions: [\n\t\t\tnew Action(\"openClose\").setLabel((ctx: WbToolTab<C>) => ctx._shown ? \"Refermer ce volet\" : \"Ouvrir ce volet\")\n\t\t\t\t.setExecute((ctx: WbToolTab<C>, ev) => {\n\t\t\t\t\tif (ctx._shown) ctx.parentViewCtn.unselectTab();\n\t\t\t\t\telse ctx.parentViewCtn.selectTab(ctx);\n\t\t\t\t}),\n\t\t\tnew Action(\"move\").setLabel(\"D√©placer ce volet...\").setExecute((ctx: WbToolTab<C>, ev) => {\n\t\t\t\tctx.parentViewCtn.onMoveTab(ctx, ev);\n\t\t\t})\n\t\t], actionContext: this\n\t};\n\n\tprotected _initialize(init: OTabInit<C>) {\n\t\t//init config\n\t\tthis.parentViewCtn = init.parentViewCtn as WbTools<C>;\n\t\tthis.view = init.view;\n\t\tthis.area = init.area;\n\t\t//init en dur de OButtonConfig\n\t\tthis.setAttribute(\"role\", \"button\"); //XXX aria role d√©di√© pour tab ?\n\t\tBASIS.makeClickable(this);\n\t\t//pas de shadowDom\n\t\tthis._createIcon();\n\t\tthis.ondblclick = (ev) => {\n\t\t\tif (ContextMenuDeskFeat.isIn(desk)) desk.showContextMenu.call(document.body, ev);\n\t\t}\n\t}\n\n\tasync show(lastDatas?: JLastDatas): Promise<void> {\n\t\tconst layout = (this.parentViewCtn as WbTools<any>).isVerticalPan ? \"v\" : \"h\";\n\t\tif ((this.area as IWbToolLocatedArea).layout !== layout) {\n\t\t\t//Wrap this.area avec les info de layout.\n\t\t\tconst unlocated = (this.area as IWbToolLocatedArea).unlocatedArea || this.area;\n\t\t\tconst located = Object.create(unlocated) as IWbToolLocatedArea;\n\t\t\tlocated.layout = layout;\n\t\t\tlocated.unlocatedArea = unlocated;\n\t\t\tthis.area = located;\n\t\t}\n\t\tawait super.show(lastDatas);\n\t}\n\n\tprotected _refresh() {\n\t\tsuper._refresh();\n\t\tDOM.setAttr(this._iconElt, \"title\", VIEWS.getDescription(this.view || this) || VIEWS.getLabel(this.view || this)); //pour le mode collaps√©.\n\t}\n}\n\ncustomElements.define('c-wb-tooltab', WbToolTab);\n\nconst allPos = [\"lt\", \"lb\", \"bl\", \"br\", \"rt\", \"rb\"];"]}