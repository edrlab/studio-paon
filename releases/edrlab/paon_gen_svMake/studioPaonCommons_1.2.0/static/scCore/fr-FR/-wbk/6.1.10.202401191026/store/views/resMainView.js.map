{"version":3,"sources":["/@back@/store/views/resMainView.tsx"],"names":["REG","Action","POPUP","DownloadRes","EditMetasRes","EditPermsRes","ImportRes","MoveRes","OpenViewRes","RemoveRes","RenameRes","VisStateRes","addEditAction","action","reg","addToList","getId","addInfoAction","setIcon","setLabel","setExecute","async","ctx","ev","infoArea","env","resType","resView","from","target","ct","loadBody","shadowRoot","installSkin","isConnected","showFloating","popup","closeOnBlur","setVisible","prcIsFolder","registerSkin"],"mappings":"OAAqBA,QAAI;OACjBC,WAAgB;OAEhBC,UAAqB;OACrBC,YAAaC,aAAcC,aAAcC,UAAWC,QAASC,YAAaC,UAAWC,UAAWC,gBAAY;;AASpH,SAASC,cAAcC,QACtBb,IAAIc,IAAIC,UAAU,iCAAkCF,OAAOG,QAAS,EAAGH,QAGxED,cAAc,IAAIN;AAClBM,cAAc,IAAIR;AAClBQ,cAAc,IAAIP;AAClBO,cAAc,IAAIL;AAClBK,cAAc,IAAIF;AAClBE,cAAc,IAAID;AAClBC,cAAc,IAAIH;AAQlB,SAASQ,cAAcJ,QACtBb,IAAIc,IAAIC,UAAU,kCAAmCF,OAAOG,QAAS,EAAGH,QAGzEI,cAAc,IAAIT;AAElBS,cAAc,IAAIhB,OAAoC,eACpDiB,QAAQ,yCACRC,SAAS,6BACTC,WAAWC,MAAOC,IAAkCC,MACpD,MAAMC,SAAWF,IAAIR,IAAIW,IAAIC,QAAQC,QAAQ;AAC7C,MAAMC,KAAOL,GAAGM;AAChB,MAAMC,SAAWN,SAASO,SAAST;AACnC,GAAIQ,GAAGE,WAAYV,IAAIR,IAAImB,YAAY,eAAgBH,GAAGE;AAC1D,IAAKJ,KAAKM,YAAa;AACvBhC,MAAMiC,aAAcC,OACZN,GACLF,KAAMA,KAAM,CAACS,YAAa;AAI/BpB,cAAc,IAAId,YAAY,KAAM,MAAMmC,WAAYhB,MAAS,GAAIA,IAAIR,IAAIW,IAAIC,QAAQa,YAAa,OAAO;AAK3GvC,IAAIc,IAAI0B,aAAa,iBAAkB,EAAsB;AAqD7DxC,IAAIc,IAAI0B,aAAa,qBAAsB,EAAsB","sourcesContent":["import {IRegPointer, REG} from \"lib/commons/registry\";\nimport {Action, IAction} from \"lib/commons/actions\";\nimport {IDepotResUiEnv} from \"lib/store/depot\";\nimport {POPUP, PopupFloating} from \"back/commons/widgets/popups\";\nimport {DownloadRes, EditMetasRes, EditPermsRes, ImportRes, MoveRes, OpenViewRes, RemoveRes, RenameRes, VisStateRes} from \"back/store/actions/resActions\";\nimport {IDepotResCtx, IDepotShortResCtx} from \"lib/store/res\";\nimport \"back/store/widgets/resGrid\";\n\n//Actions et skins ResMainArea.\n\n/**\n * Actions d'édition\n */\nfunction addEditAction(action: IAction<IDepotShortResCtx | IDepotResCtx>) {\n\tREG.reg.addToList(\"actions:depot:resMainView:edit\", action.getId(), 1, action);\n}\n\naddEditAction(new ImportRes());\naddEditAction(new EditMetasRes());\naddEditAction(new EditPermsRes());\naddEditAction(new MoveRes());\naddEditAction(new RenameRes());\naddEditAction(new VisStateRes());\naddEditAction(new RemoveRes());\n\n\n//cf trashUnlistActions.tsx#switchVisState2TrashUnlistActions(REG.reg, \"actions:depot:resMainView:edit\")\n\n/**\n * Actions de visu d'infos\n */\nfunction addInfoAction(action: IAction<IDepotShortResCtx | IDepotResCtx>) {\n\tREG.reg.addToList(\"actions:depot:resMainView:infos\", action.getId(), 1, action);\n}\n\naddInfoAction(new OpenViewRes());\n\naddInfoAction(new Action<IRegPointer<IDepotResUiEnv>>(\"infoDetails\")\n\t.setIcon(\"/@skin@/store/views/resViews/info.svg\")\n\t.setLabel(\"Informations détaillées\")\n\t.setExecute(async (ctx: IRegPointer<IDepotResUiEnv>, ev?: Event) => {\n\t\tconst infoArea = ctx.reg.env.resType.resView(\"infos\");\n\t\tconst from = ev.target as HTMLElement;\n\t\tconst ct = await infoArea.loadBody(ctx);\n\t\tif (ct.shadowRoot) ctx.reg.installSkin('webzone:page', ct.shadowRoot);\n\t\tif (!from.isConnected) return; //racecond\n\t\tPOPUP.showFloating((popup: PopupFloating) => {\n\t\t\treturn ct;\n\t\t}, from, from, {closeOnBlur: true});\n\t})\n);\n\naddInfoAction(new DownloadRes(null, null).setVisible((ctx) => {if (ctx.reg.env.resType.prcIsFolder) return false}));\n\n/**\n * Skin de la vue principale d'une ressource.\n */\nREG.reg.registerSkin(\"store-res-main\", 1, /* language=CSS */ `\n\t:host {\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: column;\n\t}\n\n\t[hidden] {\n\t\tdisplay: none;\n\t}\n\n\theader {\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: row;\n\t\tpadding: .7em;\n\t\tborder-bottom: 1px solid var(--border-color);\n\t}\n\n\tstore-res-anc {\n\t\tflex: 1;\n\t}\n\n\t#resEdit {\n\t\tflex-wrap: wrap;\n\t\tjustify-content: flex-end;\n\t}\n\n\tmain {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: column;\n\t\tmax-width: 60em;\n\t\tbox-sizing: border-box;\n\t\twidth: 100%;\n\t\tpadding: 1em 1em 0;\n\t\talign-self: center;\n\t}\n\n\tstore-res-infos {\n\t\tmargin-bottom: 1em;\n\t}\n\n\tstore-res-infos:last-child {\n\t\tborder-bottom: 1px solid var(--border-color);\n\t}\n`);\n\n/** Style pour le header de la mainView */\nREG.reg.registerSkin(\"store-res-titlebar\", 1, /* language=CSS */ `\n\t:host {\n\t\tflex-shrink: 0;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: column;\n\t\tpadding: 0 .5em;\n\t}\n\n\t#title, #version {\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t\tmin-width: 0;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tmargin-bottom: 1em;\n\t}\n\n\t.label {\n\t\tfont-variant: all-small-caps;\n\t\tcolor: var(--fade-color);\n\t}\n\n\t.icon {\n\t\tfilter: var(--filter);\n\t\theight: 2em;\n\t}\n\n\n\t#nameCtn {\n\t\tflex: 1;\n\t\tmargin: 0 .5em;\n\t  font-size: 1.6em;\n\t}\n\n\t.name {\n\t\tfont-weight: bold;\n\t}\n\n\t.unlisted {\n\t\tbackground: no-repeat right .2em top .2em / .5em url(/@skin@/store/states/limited.svg);\n\t\tpadding-inline-end: 1em;\n\t}\n\n\t.trashed {\n\t\tbackground: no-repeat right .2em top .2em / .5em url(/@skin@/store/states/invisible.svg);\n\t\tpadding-inline-end: 1em;\n\t}\n\n\n  #version > store-res-versions {\n\t  flex: 1;\n\t  background-color: var(--alt1-bgcolor);\n\t  background-position: right .3em center;\n\t  border-radius: .4em;\n\t  font-weight: bold;\n\t  margin-inline-end: .5em;\n\t  justify-content: start;\n\t  opacity: 1 !important;\n\t  padding: .3em .5em;\n  }\n\n  #versionInTi {\n\t  padding-inline-start: .3em;\n\t  color: var(--alt1-color);\n  }\n  \n  #versionInTi > store-res-versions {\n\t  display: inline;\n\t  font-size: 1em;\n\t  padding-inline-start: 1.1em;\n\t  padding-inline-end: 0;\n\t  background: var(--dropdown-url) no-repeat left / 1em;\n  }\n`);"]}