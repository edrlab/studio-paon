{"version":3,"sources":["/@back@/styler/widgets/widgets.tsx"],"names":["REG","JSX","ShadowJsx","DOMSH","BaseElement","WSPPACK","POPUP","STYLER","StylerSkinCLass","[object Object]","init","sr","this","attachShadow","SHADOWDOM_INIT","_initAndInstallSkin","localName","reg","findReg","skinCLass","titleElt","appendChild","createElement","promiseTooltip","async","owner","tooltip","skin","skinOver","makeTooltip","tooltipOf","hoverAllowed","anchor","posFrom","fromX","marginX","notAvailableSpace","targetX","refresh","super","_refresh","skinClass","getSkinClass","env","wsp","textContent","name","returnElt","wspTypesDefList","listWspTypesDef","universe","packServer","mainUlPropsElt_models","class","length","listModels","sort","e1","e2","isOption","title","localeCompare","forEach","skinClassGenerators","_a","generators","filter","entry","model","ulModelElt","gen","registerSkin","customElements","define"],"mappings":"OAAcA,QAAI;OACVC,IAAKC,cAAU;OACfC,UAAM;OACNC,gBAA2B;OACZC,YAAQ;OACvBC,UAAoB;OAGpBC,WAAO;OAUT,MAAOC,wBAAwBJ,YAO1BK,YAAYC,MACrB,MAAMC,GAAKC,KAAKC,aAAaV,MAAMW;AACnCF,KAAKG,oBAAoBH,KAAKI,UAAWN;AAEzCE,KAAKK,IAAML,KAAKM,QAAQR;AACxBE,KAAKO,UAAYT,KAAKS;AAEtBP,KAAKQ,SAAWT,GAAGU,YAAYpB,IAAAqB,cAAA,MAAA;AAW/BhB,MAAMiB,eAAeX,KAAMY,MAAOC,MAAoBC,UAC7CzB,IAAAqB,cAAA,QAAA,CAAOK,KAAK,2BAA2BC,SAAS,gBACtD3B,IAAAqB,cAACpB,UAAS,WACFU,KAAKiB,gBAIf,CACCD,SAAU,2BACVE,UAAWlB,KACXmB,aAAc,KACdC,OAAQ,CACPC,QAASrB,KACTsB,MAAO,MACPC,SAAU,EACVC,kBAAmB,CAClBH,QAASrB,KACTsB,MAAO,QACPG,QAAS,MACTF,QAAS;AAKbvB,KAAK0B,UAGI7B,WACT8B,MAAMC;AACN,MAAMC,UAAYlC,OAAOmC,aAAa9B,KAAKK,IAAI0B,IAAIC,IAAKhC,KAAKO;AAC7DP,KAAKQ,SAASyB,YAAcJ,UAAYA,UAAUK,KAAOlC,KAAKO,UAGrDV,oBACT,MAAMsC,UAAY9C,IAAAqB,cAAA,MAAA;AAClB,MAAM0B,sBAAwB3C,QAAQ4C,gBAAgBrC,KAAKK,IAAI0B,IAAIO,SAASC,WAAY,CAACvC,KAAKO,WAAY;AAE1G4B,UAAU1B,YAAYpB,IAAAqB,cAAA,MAAA,KAAA;AACtB,MAAM8B,sBAAwBL,UAAU1B,YAAYpB,IAAAqB,cAAA,MAAA,CAAK+B,MAAM;AAC/D,GAAIL,gBAAgBM,OAAS,EAAG,CAC/B,MAAMC,WAAaH,sBAAsB/B,YAAYpB,IAAAqB,cAAA,KAAA;AACrD0B,gBAAgBQ,KAAK,CAACC,GAAIC,MACzB,GAAKD,GAAqBE,WAAcD,GAAqBC,SAAU,OAAO;AAC9E,GAAKD,GAAqBC,WAAcF,GAAqBE,SAAU,OAAQ;AAC/E,OAAOD,GAAGE,MAAMC,cAAcJ,GAAGG,SAC/BE,QAASrC;AACX,MAAMsC,qBAAsBC,GAAAvC,MAAMwC,cAAU,MAAAD,UAAA,OAAA,EAAAA,GAAEE,OAAQC,OAAUA,MAAM1B,YAAc7B,KAAKO;AACzF,IAAI4C,sBAAmB,MAAnBA,2BAAmB,OAAA,EAAnBA,oBAAqBT,QAAS,EAAG,CACpC,MAAMc,MAAQ3C,MAAMmC;AACpB,MAAMS,WAAad,WAAWlC,YAAYpB,IAAAqB,cAAA,KAAA,CAAI+B,MAAM,SAAQpD,IAAAqB,cAAA,OAAA,CAAM+B,MAAM,SAAS,YAAYe,aAAwB/C,YAAYpB,IAAAqB,cAAA,KAAA;AACjIyC,oBAAoBP,KAAK,CAACC,GAAIC,KAAOD,GAAGX,KAAKe,cAAcH,GAAGZ,OAAOgB,QAASK,QAC7E,MAAMG,IAAMH,MAAMrB;AAClBuB,WAAWhD,YAAYpB,IAAAqB,cAAA,KAAA,KAAK,gBAAgBgD,oBAK/ClB,sBAAsB/B,YAAYpB,IAAAqB,cAAA,OAAA,CAAM+B,MAAM,QAAM;AACrD,OAAON,WAIT/C,IAAIiB,IAAIsD,aAAa,mBAAoB,EAAsB;AAyB/DvE,IAAIiB,IAAIsD,aAAa,2BAA4B,EAAsB;AA4BvEC,eAAeC,OAAO,mBAAoBjE","sourcesContent":["import {IReg, REG} from 'lib/commons/registry';\nimport {JSX, ShadowJsx} from \"lib/commons/xml/dom\";\nimport {DOMSH} from \"lib/commons/xml/domsh\";\nimport {BaseElement, OSkinableInit} from \"back/commons/basis\";\nimport {JWspOptionDef, WSPPACK} from \"lib/wsp/pack\";\nimport {POPUP, PopupTooltip} from \"back/commons/widgets/popups\";\nimport {IView} from \"lib/commons/views\";\nimport {IItemUiEnv} from \"back/wsp/views/itemMain\";\nimport {STYLER} from \"lib/styler/styler\";\n\n\n/**\n * Widget d'affichage d'un \"skinClass\"\n */\nexport interface OStylerSkinCLassInit extends OSkinableInit {\n\tskinCLass: string;\n}\n\nexport class StylerSkinCLass extends BaseElement {\n\tprotected skinCLass: string;\n\n\tprivate titleElt: HTMLDivElement;\n\n\tprivate reg: IReg<IItemUiEnv>;\n\n\tprotected _initialize(init: OStylerSkinCLassInit) {\n\t\tconst sr = this.attachShadow(DOMSH.SHADOWDOM_INIT);\n\t\tthis._initAndInstallSkin(this.localName, init);\n\n\t\tthis.reg = this.findReg(init);\n\t\tthis.skinCLass = init.skinCLass;\n\n\t\tthis.titleElt = sr.appendChild(<div/>) as HTMLDivElement;\n\t\t/*\n\t\tthis.addEventListener(\"click\", async ()=>{\n\t\t\tPOPUP.showDialog<string | null>(<c-box skin=\"styler-skinclass/tooltip\" >\n\t\t\t\t<ShadowJsx>\n\t\t\t\t\t{await this.makeTooltip()}\n\t\t\t\t</ShadowJsx>\n\t\t\t</c-box>, this, {titleBar: {barLabel: {label: \"Nouveau dossier des favoris\"}}, resizer: {}}).onNextClose();\n\t\t});\n\t\t*/\n\n\t\tPOPUP.promiseTooltip(this, async (owner: HTMLElement, tooltip: PopupTooltip): Promise<IView | null> => {\n\t\t\t\treturn <c-box skin=\"styler-skinclass/tooltip\" skinOver=\"scroll/large\">\n\t\t\t\t\t<ShadowJsx>\n\t\t\t\t\t\t{await this.makeTooltip()}\n\t\t\t\t\t</ShadowJsx>\n\t\t\t\t</c-box>\n\t\t\t},\n\t\t\t{\n\t\t\t\tskinOver: 'styler-skinclass/tooltip',\n\t\t\t\ttooltipOf: this,\n\t\t\t\thoverAllowed: true,\n\t\t\t\tanchor: {\n\t\t\t\t\tposFrom: this,\n\t\t\t\t\tfromX: 'end',\n\t\t\t\t\tmarginX: -1,\n\t\t\t\t\tnotAvailableSpace: {\n\t\t\t\t\t\tposFrom: this,\n\t\t\t\t\t\tfromX: 'start',\n\t\t\t\t\t\ttargetX: 'end',\n\t\t\t\t\t\tmarginX: 1\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.refresh();\n\t}\n\n\tprotected _refresh() {\n\t\tsuper._refresh();\n\t\tconst skinClass = STYLER.getSkinClass(this.reg.env.wsp, this.skinCLass);\n\t\tthis.titleElt.textContent = skinClass ? skinClass.name : this.skinCLass;\n\t}\n\n\tprotected async makeTooltip(): Promise<HTMLElement> {\n\t\tconst returnElt = <div/>;\n\t\tconst wspTypesDefList = await WSPPACK.listWspTypesDef(this.reg.env.universe.packServer, [this.skinCLass], true);\n\n\t\treturnElt.appendChild(<div>Usages dans les modèles documentaires installés : </div>)\n\t\tconst mainUlPropsElt_models = returnElt.appendChild(<div class=\"models\"/>);\n\t\tif (wspTypesDefList.length > 0) {\n\t\t\tconst listModels = mainUlPropsElt_models.appendChild(<ul/>) as HTMLUListElement;\n\t\t\twspTypesDefList.sort((e1, e2) => {\n\t\t\t\tif ((e1 as JWspOptionDef).isOption && !(e2 as JWspOptionDef).isOption) return 1;\n\t\t\t\tif ((e2 as JWspOptionDef).isOption && !(e1 as JWspOptionDef).isOption) return -11;\n\t\t\t\treturn e2.title.localeCompare(e1.title);\n\t\t\t}).forEach((owner) => {\n\t\t\t\tconst skinClassGenerators = owner.generators?.filter((entry) => entry.skinClass === this.skinCLass);\n\t\t\t\tif (skinClassGenerators?.length > 0) {\n\t\t\t\t\tconst model = owner.title;\n\t\t\t\t\tconst ulModelElt = listModels.appendChild(<li class=\"model\"><span class=\"title\">{`Modèle '${model}'`}</span></li>).appendChild(<ul/>);\n\t\t\t\t\tskinClassGenerators.sort((e1, e2) => e1.name.localeCompare(e2.name)).forEach((entry) => {\n\t\t\t\t\t\tconst gen = entry.name;\n\t\t\t\t\t\tulModelElt.appendChild(<li>{`Générateur '${gen}'`}</li>);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else\n\t\t\tmainUlPropsElt_models.appendChild(<span class=\"info\">aucun</span>);\n\t\treturn returnElt;\n\t}\n}\n\nREG.reg.registerSkin('styler-skinclass', 1, /* language=CSS */ `\n\t:host {\n\t\tbackground-color: #9e81bd;\n\t\tcolor: white;\n\t\tdisplay: inline-flex;\n\t\tmin-height: 0;\n\t\tmin-width: 5em;\n\t\tborder-radius: 2px 8px 8px 2px;\n\t\tmargin: 1px;\n\t\tpadding: 1px 3px 1px 3px;\n\t\tcursor: pointer;\n\t\tbackground-image: url(\"/@skin@/styler/widgets/skinClass.svg\");\n\t\tbackground-position: 2px;\n\t\tbackground-size: auto .7em;\n\t\tbackground-repeat: no-repeat;\n\t\tpadding-inline-start: 1.2em;\n\t\tbox-shadow: 1px 1px 2px 0px #bbb;\n\t}\n\n\t:host([hidden]) {\n\t\tdisplay: none;\n\t}\n\n`);\n\nREG.reg.registerSkin('styler-skinclass/tooltip', 1, /* language=CSS */ `\n\t.models {\n\t\tfont-size: .8em;\n\t\tmax-height: 20em;\n\t\tmargin-inline-start: 2em;\n\t\toverflow: auto;\n\t}\n\n\t.model {\n\t\tmargin-top: .3em;\n\t}\n\n\t.model > .title {\n\t\tcolor: var(--alt2-color);\n\t}\n\n\tul > * > ul {\n\t\tpadding-inline-start: 1.5rem;\n\t}\n\n\tul {\n\t\tmargin-block-start: 0;\n\t\tpadding-inline-start: 0em;\n\t\tlist-style-type: none;\n\t\tlist-style-type: \"- \";\n\t}\n`);\n\ncustomElements.define('styler-skinclass', StylerSkinCLass);\n\n"]}