{"version":3,"sources":["/@back@/wsp/plugins/dynGenPlg.tsx"],"names":["SimpleTagArea","REG","initApp","reg","d","desk","addAppBuilder","DynGenAppBuilder","[object Object]","super","env","resolver","resolve","this","data","dynGen","ctx","skin","skinOver","newElt","initialize"],"mappings":"OAGQA,kBAAc;OACRC,QAAI;OAYZ,SAAUC,QAAQC,IAAuBF,IAAIE,KAClD,MAAMC,EAAIC;AACVD,EAAEE,cAAc,IAAIC,iBAAiBJ,MA2BtC,MAAMI,yBAAyBP,cAM9BQ,YAAmBL,KAClBM,MAAM,iBAAkBN,IAAIO,IAAIC,SAASC,QAAQ;AAD/BC,KAAAV,IAAAA,IAInBK,cAAcM,MAAsB,cAAcA,KAAKC,SAAW,SAElEP,OAAOQ,KACN,IAAKA,IAAIC,KAAMD,IAAIC,KAAOJ,KAAKI;AAC/B,IAAKD,IAAIE,SAAUF,IAAIE,SAAWL,KAAKK;AACvCF,IAAIb,IAAMU,KAAKV;AACf,OAAQM,MAAMU,OAAOH,KAAmBI,WAAWJ","sourcesContent":["import {OSkinableInit} from \"back/commons/basis\";\nimport {AppFrameDeskFeat, IApp, IAppBuilder, IAppCtx, JAppDef} from \"back/core/appFrame\";\nimport {DynGenApp} from \"back/wsp/apps/dynGenApp\";\nimport {SimpleTagArea} from \"lib/commons/areas\";\nimport {IReg, REG} from 'lib/commons/registry';\nimport {JSX} from \"lib/commons/xml/dom\";\nimport {IChainEnv} from \"lib/wsp/chain\";\nimport {srcRef} from \"lib/wsp/src\";\nimport {wspCd} from \"lib/wsp/wsp\";\n\n/**\n * InteractiveGenerator comme une vue principale dans une appFrame.\n * A appeler au cours du processus d'init du desk (qui doit disposer de AppFrameDeskFeat).\n *\n * @param reg Registre à exploiter, nécessaire en cas de front multi-universe.\n */\nexport function initApp(reg: IReg<IChainEnv> = REG.reg) {\n\tconst d = desk as AppFrameDeskFeat;\n\td.addAppBuilder(new DynGenAppBuilder(reg));\n}\n\n/**\n * Schéma du hash de l'URL pour le DynGenApp.\n * exemple : (dynGen(w'001C42jx3eXsm0yhoUWVZb'c'edit'r'id:003C42jx3eXsm0yhoUWVZb'))\n */\nexport interface JDynGenAppDef extends JAppDef {\n\tdynGen: JDynGenDatas\n}\n\nexport interface JDynGenDatas {\n\t/** wspCd */\n\tw: wspCd\n\t/** codeGen */\n\tc: string\n\t/** refUri de la racine de la dynGen. */\n\tr: srcRef\n\t/** genProps (skin, etc) */\n\tgp?: Jsonisable\n\t/** pathPage pour construire le dialogue (\"co/\" par défaut) */\n\tpp?: string\n\t/** queryString passé au dialogue  */\n\tqs?: string\n}\n\n/** Construction async de l'app DynGenApp. */\nclass DynGenAppBuilder extends SimpleTagArea<IAppCtx<IChainEnv>, IApp<IChainEnv>> implements OSkinableInit, IAppBuilder<IChainEnv, IChainEnv> {\n\n\tskin?: string;\n\n\tskinOver?: string;\n\n\tconstructor(public reg: IReg<IChainEnv>) {\n\t\tsuper('wsp-dyngen-app', reg.env.resolver.resolve(\":back:wsp/apps/dynGenApp.js\"));\n\t}\n\n\tisAppDefMatch(data: JDynGenAppDef) {return typeof data.dynGen === 'object'}\n\n\tnewElt(ctx: IAppCtx<IChainEnv> & OSkinableInit): DynGenApp {\n\t\tif (!ctx.skin) ctx.skin = this.skin;\n\t\tif (!ctx.skinOver) ctx.skinOver = this.skinOver;\n\t\tctx.reg = this.reg;\n\t\treturn (super.newElt(ctx) as DynGenApp).initialize(ctx);\n\t}\n}\n"]}