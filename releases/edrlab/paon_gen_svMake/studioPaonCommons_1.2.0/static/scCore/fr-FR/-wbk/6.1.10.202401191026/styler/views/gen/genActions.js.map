{"version":3,"sources":["/@back@/styler/views/gen/genActions.tsx"],"names":["SRC","ERROR","POPUP","GenAction","MsgOver","STYLER","StylerInstallSkinsetAction","[object Object]","id","super","this","_label","_icon","_description","_hideForStatuses","requireEnabledPerm","ctx","ev","skinPack","setCustomMsg","showMsgOver","reg","env","uiRoot","waitFor","installGenAsSkinpack","wsp","uiContext","srcRef","shortDesc","pubNode","codeGenStack","lang","showNotifInfo","autoHide","e","report","SINGLETON"],"mappings":"OACQA,QAAI;OACJC,UAAM;OAENC,UAAM;OACNC,cAAU;OACVC,YAAQ;OAERC,WAAO;;OAGT,MAAOC,mCAAmCH,UAI/CI,YAAYC,IACXC,MAAMD,IAAM;AACZE,KAAKC,OAAS;AACdD,KAAKE,MAAQ;AACbF,KAAKG,aAAe;AACpBH,KAAKI,iBAAmB;AACxBJ,KAAKK,mBAAmB,oCAGzBR,cAAcS,IAAcC,IAC3B,IACC,IAAIC,eAAqC,IAAId,SAAUe,aAAa,0BAA2B,QAAQC,YAAYJ,IAAIK,IAAIC,IAAIC,QAAQC,QACtInB,OAAOoB,qBAAqBT,IAAIU,IAAKV,IAAIW,UAAW3B,IAAI4B,OAAOZ,IAAIa,WAAYb,IAAIc,QAAQC,aAAcf,IAAIK,IAAIC,IAAIC,OAAOS;AAE7H,GAAId,SAAU,CACbhB,MAAM+B,cAAc,0IAA2IjB,IAAIK,IAAIC,IAAIC,OAAQ,CAACW,SAAU,WAE9L,KAAM,cACN,MAAOC,GACR,OAAOlC,MAAMmC,OAAO,kDAAmDD,KArBlE7B,2BAAA+B,UAAY,IAAI/B","sourcesContent":["import {IPubCtx} from \"lib/wsp/wspMetaUi\";\nimport {SRC} from \"lib/wsp/src\";\nimport {ERROR} from \"lib/core/errorReport\";\nimport {JSX} from \"lib/commons/xml/dom\";\nimport {POPUP} from \"back/commons/widgets/popups\";\nimport {GenAction} from \"back/wsp/views/gen/genActions\";\nimport {MsgOver} from \"back/commons/basis\";\nimport {JSkinPackInstalled} from \"lib/wsp/pack\";\nimport {STYLER} from \"lib/styler/styler\";\nimport \"back/styler/views/views_Perms\";\n\nexport class StylerInstallSkinsetAction extends GenAction {\n\n\tstatic SINGLETON = new StylerInstallSkinsetAction();\n\n\tconstructor(id?: string) {\n\t\tsuper(id || \"stylerInstallSkinset\");\n\t\tthis._label = \"Installer\";\n\t\tthis._icon = \"/@skin@/styler/views/generators/install.svg\";\n\t\tthis._description = \"Installer le dernier habillage graphique compilé\";\n\t\tthis._hideForStatuses = \"failed,null\";\n\t\tthis.requireEnabledPerm(\"action.gen#install.genAsSkinPack\")\n\t}\n\n\tasync execute(ctx: IPubCtx, ev?: Event): Promise<any | 'noPreventDefault'> {\n\t\ttry {\n\t\t\tlet skinPack: JSkinPackInstalled = await new MsgOver().setCustomMsg(\"Veuillez patienter...\", \"info\").showMsgOver(ctx.reg.env.uiRoot).waitFor(\n\t\t\t\tSTYLER.installGenAsSkinpack(ctx.wsp, ctx.uiContext, SRC.srcRef(ctx.shortDesc), ctx.pubNode.codeGenStack, ctx.reg.env.uiRoot.lang)\n\t\t\t);\n\t\t\tif (skinPack) {\n\t\t\t\tPOPUP.showNotifInfo(\"L'installation du skinpack s'est déroulée avec succès.\\nVous pouvez maintenant l'utiliser (et l'activer) dans les ateliers concernés.\", ctx.reg.env.uiRoot, {autoHide: 5000});\n\t\t\t} else\n\t\t\t\tthrow \"no skinpack\";\n\t\t} catch (e) {\n\t\t\treturn ERROR.report(\"L'installation du skinpack n'a pas pu aboutir\", e);\n\t\t}\n\n\t}\n}\n"]}